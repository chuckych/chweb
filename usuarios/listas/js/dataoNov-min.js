$((function(){"use strict";let e=$("#cliente_rol").val(),t=$("#recid_rol").val(),o=$("#id_rol").val(),a=$("#tableONovedades").dataTable({initComplete:function(e,t){0===t.data.length&&($("#tableONovedades").parents(".table-responsive").hide(),$("#o_novedades").html('<div class="my-3 fontq">No se encontraron resultados</div>'))},dom:"<'row'<'col-12 divONovFilter d-flex align-items-center justify-content-between pt-1'f>><'row'<'col-12 divtableonov 't>><'row'<'col-12 d-flex align-items-center justify-content-end'><'col-12 d-flex align-items-center justify-content-between divONovInfo pt-2 pl-0 pr-0'i><'col-12 pt-2 pl-0 divRefreshONov'>>",ajax:{url:"../listas/getListas.php",type:"GET",dataType:"json",data:function(t){t._c=e,t.lista=2,t.id_rol=o},error:function(){$("#tableONovedades").css("display","none")}},createdRow:function(e,t,o){$(e).addClass("animate__animated animate__fadeIn pointer checkONove")},rowGroup:{className:"",dataSrc:function(e){return'<div class="pointer btn btn-link m-0 p-0 fontq groupONovTipo" data-tipo="'+e.idtipo+'">'+e.tipo+"</div>"}},columns:[{className:"align-middle",targets:"codigo",title:"",render:function(e,t,o,a){return o.codigo}},{className:"align-middle w-100 ",targets:"descripcion",title:"",render:function(e,t,o,a){return o.descripcion}},{className:"align-middle",targets:"",title:"",render:function(e,t,o,a){let n=1===o.set?"checked":"";return n&&setTimeout((()=>{$("#ONove_"+o.codigo).parents("tr").addClass("table-active")}),200),'\n                    <div class="custom-control custom-checkbox">\n                        <input '+n+' type="checkbox" class="custom-control-input '+("oclass_"+o.idtipo)+'" id="ONove_'+o.codigo+'" value="'+o.codigo+'">\n                        <label class="custom-control-label" for="ONove_'+o.codigo+'"></label>\n                    </div>\n                    '}}],bProcessing:!0,serverSide:!1,deferRender:!0,paging:!1,searching:!0,info:!0,ordering:0,responsive:0,language:{sProcessing:"Actualizando . . .",sLengthMenu:"_MENU_",sZeroRecords:"",sEmptyTable:"",sInfo:"_START_ al _END_ de _TOTAL_ Novedades",sInfoEmpty:"No se encontraron resultados",sInfoFiltered:"<br>(Filtrado de un total de _MAX_ Novedades)",sInfoPostFix:"",sSearch:"",sUrl:"",sInfoThousands:",",sLoadingRecords:"<div class='spinner-border text-light'></div>",oPaginate:{sFirst:"<i class='bi bi-chevron-left'></i>",sLast:"<i class='bi bi-chevron-right'></i>",sNext:"<i class='bi bi-chevron-right'></i>",sPrevious:"<i class='bi bi-chevron-left'></i>"},oAria:{sSortAscending:":Activar para ordenar la columna de manera ascendente",sSortDescending:":Activar para ordenar la columna de manera descendente"}}});a.on("init.dt",(function(){$("#tableONovedades_info").css("margin-top","0px"),$("#tableONovedades_info").addClass("p-0"),$("#tableONovedades tbody").on("click",".checkONove",(function(e){e.preventDefault();let t=$(a).DataTable().row($(this)).data();$("#ONove_"+t.codigo).is(":checked")?($("#ONove_"+t.codigo).prop("checked",!1),$(this).removeClass("table-active")):($("#ONove_"+t.codigo).prop("checked",!0),$(this).addClass("table-active"))})),$("#tableONovedades tbody").on("click",".groupONovTipo",(function(e){e.preventDefault();let t=$(this).attr("data-tipo");$(".oclass_"+t).is(":checked")?($(".oclass_"+t).prop("checked",!1),$(".oclass_"+t).parents("tr").removeClass("table-active")):($(".oclass_"+t).prop("checked",!0),$(".oclass_"+t).parents("tr").addClass("table-active"))})),$("#tableONovedades_filter .form-control").attr("placeholder","Buscar Novedad"),$(this).children("thead").remove(),$(".divtableonov").css("max-height","300px"),$(".divtableonov").addClass("overflow-auto");$(this).parents().find(".divONovFilter").prepend('\n            <div class="">\n                <button class="btn btn-link btn-sm fontq" id="checkAllONov">Marcar</button>\n                <button class="ml-1 btn btn-link btn-sm fontq" id="nocheckAllONov">Desmarcar</button>\n            </div>\n            '),$(this).parents().find(".divONovInfo").append('\n            <div class="">\n                <button type="button" class="btn btn-custom btn-sm btn-mobile fontq w100" id="aplicarONove">Aplicar</button>\n            </div>\n            '),$(this).parents().find(".divRefreshONov").append('\n            <div class="">\n                <button class="btn btn-link btn-sm fontq p-0 m-0" id="refreshONovList">Actualizar Grilla</button>\n            </div>\n            '),$("#refreshONovList").on("click",(function(e){e.preventDefault(),$("#tableONovedades").DataTable().ajax.reload()})),$("#checkAllONov").on("click",(function(){$("#tableONovedades input:checkbox").prop("checked",!0),$("#tableONovedades tr").addClass("table-active")})),$("#nocheckAllONov").on("click",(function(){$("#tableONovedades input:checkbox").prop("checked",!1),$("#tableONovedades tr").removeClass("table-active")})),$("#aplicarONove").on("click",(function(){CheckSesion();let e=new Array;$("#tableONovedades input:checkbox:checked").each((function(){e.push(parseInt($(this).val()))})),$.ajax({url:"../listas/setLista.php",type:"POST",data:{lista:2,check:JSON.stringify(e),id_rol:o,recid_rol:t},beforeSend:function(e){$.notifyClose(),notify("Aguarde..","info",0,"right")},success:function(e){"ok"==e.status?($.notifyClose(),notify(e.Mensaje,"success",5e3,"right"),$("#tableONovedades").DataTable().ajax.reload()):($.notifyClose(),notify(e.Mensaje,"danger",5e3,"right"),$("#tableONovedades").DataTable().ajax.reload())},error:function(e){$.notifyClose(),notify("Error","danger",5e3,"right")}})}))}))}));