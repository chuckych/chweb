$((function(){"use strict";let e=!0;if(fetch("../clientes/testConnect.php?_c="+$("#_c").val()).then((e=>e.json())).then((a=>{"Error"==a.status&&(e=!1,$("#f1").hide(),notify("No hay conexión con Control Horario","warning",5e3,"right"))})),$("#table-personal thead tr").clone(!0).appendTo("#table-personal thead"),$("#table-personal thead tr:eq(1) th").each((function(e){$(this).text();$(this).html('<input type="text" class="form-control" placeholder="" />'),$("input",this).on("keyup change",(function(){table.column(e).search()!==this.value&&table.column(e).search(this.value).draw()}))})),$("#DivLegaPass").hide(),e){let e=$("#table-personal").DataTable({createdRow:function(e,a,t){$(e).addClass("animate__animated animate__fadeIn fila"),$("td",e).addClass("align-middle")},bProcessing:!0,orderCellsTop:!0,fixedHeader:!0,ajax:{url:"?p=array_personal.php",type:"GET",dataSrc:"personal",data:function(e){e._c=$("#_crecid").val(),e.LegaPass=$("#LegaPass").val()}},dom:"<'row'<'col-12 col-sm-6 d-inline-flex justify-content-start align-items-center'l<'divCheck'>><'col-12 col-sm-6 d-flex justify-content-end'<'divAlta'>f>><'row'<'col-12 table-responsive mt-sm-0 mt-2't>><'row mt-2'<'col-12 col-sm-5'i><'col-12 col-sm-7 d-flex justify-content-end'p>>",deferRender:!0,columns:[{class:"",data:"check"},{class:"",data:"pers_dni"},{data:"pers_nombre"},{data:"pers_empresa"},{data:"pers_planta"},{data:"pers_sector"},{data:"pers_grupo"},{data:"pers_sucur"}],lengthMenu:[[10,25,50,100,200,300],[10,25,50,100,200,300]],scrollY:"30vh",scrollX:!0,scrollCollapse:!0,paging:!0,searching:!0,info:!0,ordering:0,language:{url:"../../js/DataTableSpanishShort2.json?"+vjs()}});cargando_table(),e.on("init.dt",(function(e,a){let t="#"+e.target.id,n=$(t+"_length select");$(n).addClass("h35");let r=$(t+"_filter input");$(r).attr({placeholder:"Buscar dato..",autocomplete:"off"}),$("#DivLegaPass").on("click",(function(e){e.preventDefault(),$("#LegaPass").is(":checked")?($("#LegaPass").val("false"),$("#LegaPass").prop("checked",!1),$("#table-personal").DataTable().ajax.reload()):($("#LegaPass").val("true"),$("#LegaPass").prop("checked",!0),$("#table-personal").DataTable().ajax.reload()),$(".LegaCheck ").attr("disabled",!0),cargando_table()})),2==a.iDraw&&($("#DivLegaPass").show(),$(".divCheck").html('\n                <div class="d-flex align-items-center ml-2">\n                    <button type="button" class="p-0 fontq btn btn-link text-secondary mr-2" id="marcar"><i class="bi bi-check2-square mr-2"></i>Marcar</button>\n                    <button type="button" class="p-0 fontq btn btn-link text-secondary" id="desmarcar">\n                        <i class="bi bi-dash-square mr-2"></i>\n                        Desmarcar\n                    </button>\n                </div>\n            '),$("#marcar").on("click",(function(e){e.preventDefault(),$(".LegaCheck").prop("checked",!0)})),$("#desmarcar").on("click",(function(e){e.preventDefault(),$(".LegaCheck").prop("checked",!1)})))})),e.on("draw.dt",(function(e,a){a.iDraw>1&&$("._cargando").remove()}))}onOpenSelect2();let a="0",t=!1,n="10",r="250",o=!0;$(".SelecRol").select2({language:"es",multiple:!1,allowClear:o,language:"es",placeholder:"Seleccionar Rol",minimumInputLength:a,minimumResultsForSearch:10,maximumInputLength:n,selectOnClose:t,language:{noResults:function(){return"No hay resultados.."},inputTooLong:function(e){var a="Máximo "+n+" caracteres. Elimine "+overChars+" caracter";return 1!=overChars&&(a+="es"),a},searching:function(){return"Buscando.."},errorLoading:function(){return"Sin datos.."},removeAllItems:function(){return"Borrar"},inputTooShort:function(){return"Ingresar "+a+" o mas caracteres"},maximumSelected:function(){return"Puede seleccionar solo una opción"},loadingMore:function(){return"Cargando más resultados…"}},ajax:{url:"getRoles.php",dataType:"json",type:"POST",delay:r,data:function(e){return{q:e.term,_c:getParameterByName("_c")}},processResults:function(e){return{results:e}}}}),$(".SelecRol").on("select2:select",(function(e){$(".select2-container").removeClass("border border-danger"),$.notifyClose()})),$("#f1").bind("submit",(function(e){if(e.preventDefault(),!$(".SelecRol").val()){return $.notifyClose(),$(".select2-container").addClass("border border-danger"),void notify('<span class="">Debe seleccionar un rol<span>',"danger",0,"right")}$.ajax({type:$(this).attr("method"),url:$(this).attr("action"),data:$(this).serialize()+"&submit=Importar",beforeSend:function(e){$.notifyClose(),notify("Aguarde. . .","dark",0,"right"),ActiveBTN(!0,"#submit","Aguarde. . .",'<i class="bi-download font1 mr-2"></i>IMPORTAR')},success:function(e){"ok"==e.status?($.notifyClose(),notify(e.Mensaje,"success",5e3,"right"),cargando_table(),$("#table-personal").DataTable().ajax.reload()):($.notifyClose(),notify(e.Mensaje,"danger",5e3,"right")),ActiveBTN(!1,"#submit","Aguarde. . .",'<i class="bi-download font1 mr-2"></i>IMPORTAR')},error:function(e){ActiveBTN(!1,"#submit","Aguarde. . .",'<i class="bi-download font1 mr-2"></i>IMPORTAR'),$.notifyClose(),notify("Error","danger",5e3,"right")}}),e.stopImmediatePropagation()}))}));