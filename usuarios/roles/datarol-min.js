$(document).ready((function(){$("#collapse_rol").on("shown.bs.collapse",(function(){$("#nombre").focus()})),$(document).on("click",".editRol",(function(t){t.preventDefault();var a=$(this).attr("datarol"),e=$(this).attr("dataidrol"),s=$(this).attr("datarecid_c");setTimeout(()=>{$(".modal-footer").addClass("bg-light"),$(".modal-header").addClass("border-bottom-0"),$(".bootbox-input-text").addClass("h40"),$(".bootbox-input-text").val(a),$(".bootbox-input-text").select(),$(".bootbox-input-text").attr("placeholder","Nombre Rol")},200),bootbox.addLocale("custom",{OK:"OK",CONFIRM:"Confirmar",CANCEL:"Cancelar"}),bootbox.prompt({size:"small",buttons:{confirm:{label:"Guardar",className:"btn-custom btn-sm fontq btn-mobile"},cancel:{label:"Cancelar",className:"btn-outline-custom border btn-sm fontq btn-mobile"}},title:"<span class='fonth text-secondary'>Editar Rol: "+a+"</span>",locale:"custom",callback:function(t){t&&$.ajax({type:"POST",url:"crudRol.php",data:{submit:"editarol",id:e,nombre:a,recid_c:s,nombre_nuevo:t},beforeSend:function(t){$("#Editar_"+e).prop("disabled",!0)},success:function(t){"ok"==t.status?($("#Editar_"+e).prop("disabled",!1),$("#respuesta").html('<div class="mt-2 animate__animated animate__fadeInDown alert alert-success alert-dismissible fade show fontq" role="alert"><strong>'+t.Mensaje+'</strong><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),$("#GetRoles").DataTable().ajax.reload()):"nocambios"==t.status?($("#Editar_"+e).prop("disabled",!1),$("#respuesta").html("")):($("#Editar_"+e).prop("disabled",!1),$("#respuesta").html('<div class="mt-2 animate__animated animate__fadeInDown alert alert-danger alert-dismissible fade show fontq" role="alert"><strong>'+t.Mensaje+'</strong><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'))},error:function(t){$("#Editar_"+e).prop("disabled",!1),$("#respuesta").html('<div class="mt-2 animate__animated animate__fadeInDown alert alert-danger alert-dismissible fade show fontq" role="alert"><strong>Error</strong><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')}})}})})),$(document).on("click",".addRol",(function(t){t.preventDefault();var a=$("#recid_cRol").val();setTimeout(()=>{$(".modal-footer").addClass("bg-light"),$(".modal-header").addClass("border-bottom-0"),$(".bootbox-input-text").addClass("h40"),$(".bootbox-input-text").select(),$(".bootbox-input-text").attr("placeholder","Nombre del Rol")},200),bootbox.addLocale("custom",{OK:"OK",CONFIRM:"Confirmar",CANCEL:"Cancelar"}),bootbox.prompt({size:"small",buttons:{confirm:{label:"Aceptar",className:"btn-custom btn-sm fontq btn-mobile"},cancel:{label:"Cancelar",className:"btn-outline-custom border btn-sm fontq btn-mobile"}},title:"<span class='fonth text-secondary'>Alta Rol</span>",locale:"custom",callback:function(t){t&&$.ajax({type:"POST",url:"crudRol.php",data:{submit:"addRol",recid_c:a,nombre:t},beforeSend:function(t){$("#AltaRol").prop("disabled",!0)},success:function(t){"ok"==t.status?($("#AltaRol").prop("disabled",!1),$("#respuesta").html('<div class="mt-2 animate__animated animate__fadeInDown alert alert-success alert-dismissible fade show fontq" role="alert"><strong>'+t.Mensaje+'</strong><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),$("#GetRoles").DataTable().ajax.reload()):"nocambios"==t.status?($("#AltaRol").prop("disabled",!1),$("#respuesta").html("")):($("#AltaRol").prop("disabled",!1),$("#respuesta").html('<div class="mt-2 animate__animated animate__fadeInDown alert alert-danger alert-dismissible fade show fontq" role="alert"><strong>'+t.Mensaje+'</strong><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'))},error:function(t){$("#AltaRol").prop("disabled",!1),$("#respuesta").html('<div class="mt-2 animate__animated animate__fadeInDown alert alert-danger alert-dismissible fade show fontq" role="alert"><strong>Error</strong><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')}})}})})),$(document).on("click",".deleteRol",(function(t){t.preventDefault();var a=$(this).attr("datarol"),e=$(this).attr("dataidrol");$(this).attr("datarecid_c");bootbox.confirm({message:'<span class="fonth fw4">Â¿Confirma eliminar el Rol: <span class="fw5">'+a+"</span>?</span>",buttons:{confirm:{label:"Confirmar",className:"btn-custom btn-sm fontq btn-mobile"},cancel:{label:"Cancelar",className:"btn-outline-custom border btn-sm fontq btn-mobile"}},callback:function(t){$(".deleteRol").unbind("click"),t&&$.ajax({type:"POST",url:"crudRol.php",data:{submit:"deleteRol",id:e,nombre:a},beforeSend:function(t){$("#delete_"+e).prop("disabled",!0)},success:function(t){"ok"==t.status?($("#delete_"+e).prop("disabled",!1),$("#respuesta").html('<div class="mt-2 animate__animated animate__fadeInDown alert alert-success alert-dismissible fade show fontq" role="alert"><strong>'+t.Mensaje+'</strong><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),$("#GetRoles").DataTable().ajax.reload()):($("#delete_"+e).prop("disabled",!1),$("#respuesta").html('<div class="mt-2 animate__animated animate__fadeInDown alert alert-danger alert-dismissible fade show fontq" role="alert"><strong>'+t.Mensaje+'</strong><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'))},error:function(t){$("#delete_"+e).prop("disabled",!1),$("#respuesta").html('<div class="mt-2 animate__animated animate__fadeInDown alert alert-danger alert-dismissible fade show fontq" role="alert"><strong>Error</strong><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')}})}}),t.stopImmediatePropagation()}));var t=$("#GetRoles").DataTable({initComplete:function(t,a){$(".form-control-sm").attr("placeholder","Buscar Rol"),$(".LabelSearchDT").html(""),$("#GetRoles_filter").prepend('<button title="Nuevo Rol" class="px-2 btn btn-outline-custom addRol fontq border" id="AltaRol"><span><svg class="" width="20" height="20" fill="currentColor"><use xlink:href="../../img/bootstrap-icons.svg#plus-circle-fill"/></svg></span></button>'),$(".table-responsive").show(),fadeInOnly("#GetRoles"),$(".addRol").hover((function(){$(this).find("span").html('<span class="animate__animated animate__fadeIn"><svg class="mr-2" width="20" height="20" fill="currentColor"><use xlink:href="../../img/bootstrap-icons.svg#plus-circle-fill"/></svg>Nuevo Rol</span>')}),(function(){$(this).find("span").last().html('<span class="animate__animated animate__fadeIn"><svg class="" width="20" height="20" fill="currentColor"><use xlink:href="../../img/bootstrap-icons.svg#plus-circle-fill"/></svg></span>')}))},drawCallback:function(t){$(".contentd").removeClass("text-light bg-light w30")},lengthMenu:[5,10,25,50,100],columnDefs:[{visible:!1,targets:0},{visible:!1,targets:1},{visible:!1,targets:2},{visible:!1,targets:4},{visible:!1,targets:5},{visible:!1,targets:15},{visible:!1,targets:16}],bProcessing:!0,serverSide:!0,deferRender:!0,searchDelay:1500,ajax:{url:"GetRoles.php?_c="+$("#recid_cRol").val(),type:"POST",data:function(t){t.recid_c=$("#recid_cRol").val()},error:function(){$("#GetRoles_processing").hide()}},columns:[{class:"",data:"id"},{class:"",data:"recid"},{class:"",data:"recid_cliente"},{class:"",data:"nombre"},{class:"",data:"id_cliente"},{class:"",data:"cliente"},{class:"text-center",data:"cant_roles"},{class:"text-center",data:"cant_modulos"},{class:"text-center",data:"abm_rol"},{class:"text-center",data:"cant_empresas"},{class:"text-center",data:"cant_plantas"},{class:"text-center",data:"cant_convenios"},{class:"text-center",data:"cant_sectores"},{class:"text-center",data:"cant_grupos"},{class:"text-center",data:"cant_sucur"},{class:"",data:"fecha_alta"},{class:"",data:"fecha_mod"},{class:"",data:"edit_rol"}],paging:!0,responsive:!1,info:!0,searching:!0,ordering:!1,language:{url:"../../js/DataTableSpanishShort.json"}});t.page.len("5").draw(),t.on("page.dt",(function(){$(".open-modal").removeClass("btn-outline-custom"),$(".contentd").addClass("text-light bg-light w30"),$(".botones").hide()}))}));