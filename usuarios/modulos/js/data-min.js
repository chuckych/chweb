$(document).ready((function(){$.ajax({type:"POST",dataType:"json",url:"getTipoModulos.php",data:{tipo:!0},beforeSend:function(){$("#v-pills-tab").append('<div id="espera" class="fontq text-secondary fw5">Obteniendo datos..</div>')},success:function(t){"ok"==t.status&&($("#espera").remove(),$.each(t.datos,(function(t,a){var e;e=a.id,$.ajax({type:"POST",dataType:"json",url:"getTipoModulos.php",data:{modulos:!0,recidRol:getUrlParameter("_r"),tipo:e},beforeSend:function(){},success:function(t){"ok"==t.status&&$.each(t.datos,(function(t,a){$(".pills-"+a.tipo).append('<div class="col-sm-6 col-lg-4 col-xl-3 col-12"><div class="custom-control custom-checkbox"><input type="checkbox" value="'+a.id+'" name="amod[]" class="custom-control-input switch_'+a.tipo+'" id="m'+TrimEspacios(a.nombre)+'m"><label class="custom-control-label text-dark fw4" for="m'+TrimEspacios(a.nombre)+'m" style="padding-top: 3px;">'+a.nombre+"</label></div></div>")}))},error:function(){}});var o,s,i=parseFloat(a.CantMod);i>0&&($("#v-pills-tab").append('<a class="nav-link fw4 fontq btn-outline-custom border mt-1" id="'+a.id+'-tab" data-toggle="pill" dataTipo="'+a.id+'" href="#v-pills-'+a.id+'" role="tab" aria-controls="v-pills-'+a.id+'" aria-selected="false">'+a.TipoModulo+"</a>"),$("#1-tab").addClass("active"),$("#v-pills-tabContent").append('<div class="tab-pane fade" id="v-pills-'+a.id+'" role="tabpanel"  aria-labelledby="v-pills-'+a.id+'-tab"><button class="fontq fw4 btn btn-sm btn-link border-0 text-gris" id="marcar_'+a.id+'">Marcar Todo</button><button class="fontq fw4 btn btn-sm btn-link border-0 ml-2 text-gris" id="desmarcar_'+a.id+'">Desmarcar</button><p></p><form action="crud_mod.php" method="POST" id="Form_'+a.id+'"><input type="hidden" name="TipoMod" value="'+a.id+'"><div class="row pills-'+a.id+'"></div><p></p><button type="submit" class="fontq fw4 btn btn-custom border px-3" id="Guardar_'+a.id+'">Guardar</button><span class="ml-2 fw5 fontq align-middle respuesta"></span></form></div>'),$("#v-pills-1").addClass("show active"),o="#Form_"+a.id,s="#Guardar_"+a.id,$(o).bind("submit",(function(t){t.preventDefault(),$.ajax({type:$(this).attr("method"),url:$(this).attr("action"),data:$(this).serialize()+"&recidRol= "+getUrlParameter("_r"),dataType:"json",beforeSend:function(t){ActiveBTN(!0,s,"Espere..","Guardar")},success:function(t){"ok"==t.status?(ActiveBTN(!1,s,"Espere..","Guardar"),$(".respuesta").html(t.Mensaje),setTimeout(()=>{$(".respuesta").html("")},2e3)):(ActiveBTN(!1,s,"Espere..","Guardar"),$(".respuesta").html(t.Mensaje))},error:function(t){ActiveBTN(!1,s,"Espere..","Guardar"),$(".respuesta").html(t.Mensaje)}})})),$(document).on("click","#marcar_"+a.id,(function(t){$(".switch_"+a.id).prop("checked",!0),$(".switch_"+a.id).attr("name","amod[]")})),$(document).on("click","#desmarcar_"+a.id,(function(t){$(".switch_"+a.id).prop("checked",!1),$(".switch_"+a.id).attr("name","amod[]")}))),0==i&&$("#"+a.id+"-tab").addClass("disabled bg-light"),$(".nav-link").on("click",(function(t){$(".respuesta").html("")}))})),$.ajax({type:"POST",dataType:"json",url:"getTipoModulos.php",data:{activos:!0,recidRol:getUrlParameter("_r")},beforeSend:function(){},success:function(t){"ok"==t.status&&$.each(t.datos,(function(t,a){if("0"==t){var e=a.mod_roles;$.each(e,(function(t,a){$("#m"+TrimEspacios(a.modulo)+"m").prop("checked",!0)}))}})),$("#v-pills-tabContent").removeClass("d-none"),fadeInOnly("#v-pills-tabContent"),setTimeout(()=>{$("#RowModulos").removeClass("d-none"),fadeInOnly("#RowModulos")},500)},error:function(){}}))},error:function(){}})}));