function DestroyDataTablesModal(){$("#GetFichadas").DataTable().clear().draw().destroy(),$("#GetNovedades").DataTable().clear().draw().destroy(),$("#GetHoras").DataTable().clear().draw().destroy()}$(document).ready((function(){function a(){e(),$("#Tabla_General").DataTable().ajax.reload()}function e(){$(".open-modal").removeClass("btn-outline-custom"),$(".contentd").addClass("text-light bg-light w30")}$("#Refresh").on("click",(function(){a()})),$("#_dr").change((function(){CheckSesion(),a()})),$("#Refresh").on("click",(function(){CheckSesion(),a()})),$("#RefreshModal").on("click",(function(){CheckSesion(),$("#GetFichadas").DataTable().ajax.reload(),$("#GetNovedades").DataTable().ajax.reload(),$("#GetHoras").DataTable().ajax.reload(),$("#Tabla_General").DataTable().ajax.reload()})),$(".totales").addClass("invisible"),$("tbody").addClass("opa3"),$("#Tabla_General").DataTable({initComplete:function(a,e){$(".nombre").html(e.nombre),$(".totales").removeClass("invisible"),$(".totales").prop("disabled",!1),fadeInOnly(".nombre"),fadeInOnly(".totales")},drawCallback:function(a){$("#GetPersonal thead").remove(),$(".page-link").addClass("border border-0"),$(".dataTables_info").addClass("text-secondary"),$("#pagLega").removeClass("d-none"),$("#GetGeneral").DataTable().ajax.reload(),fadeInOnly("#GetGeneral"),$(".open-modal").addClass("btn-outline-custom"),$(".contentd").removeClass("text-light bg-light w30")},createdRow:function(a,e,s){$(a).addClass("animate__animated animate__fadeIn align-middle"),$.each(e,(function(s,l){var t=e.Gen_Horario;"Franco"==t&&($("td",a).css("background-color","#fafafa"),$(".open-modal",a).removeClass("btn-outline-custom"),$(".open-modal",a).addClass("btn-outline-secondary")),"Feriado"==t&&($("td",a).css("background-color","#fafafa"),$(".open-modal",a).removeClass("btn-outline-custom"),$(".open-modal",a).addClass("btn-outline-secondary"))}))},columnDefs:[{visible:!1,targets:1,type:"html"}],bProcessing:!0,serverSide:!0,deferRender:!0,searchDelay:1500,iDisplayLength:15,ajax:{url:"GetGeneralMisHoras.php",type:"POST",data:function(a){a._c=$("#_c").val(),a._r=$("#_r").val(),a._dl=$("input[name=_dl]:checked").val(),a._range="on",a._lega=$("#_lega").val(),a._dr=$("#_dr").val()},error:function(){$("#Tabla_General_processing").css("display","none")}},columns:[{class:"px-2",data:"modal"},{class:"",data:"LegNombre"},{class:"",data:"FechaDia"},{class:"ls1 ",data:"Gen_Horario"},{class:"ls1 text-center",data:"Primera"},{class:"ls1 text-center",data:"Ultima"},{class:"",data:"DescHoras"},{class:"text-center fw4 ls1",data:"HsAuto"},{class:"text-center ls1",data:"HsCalc"},{class:"",data:"Novedades"},{class:"text-center fw4 ls1",data:"NovHor"}],bLengthChange:!1,paging:!0,searching:!1,info:!0,ordering:!1,responsive:!1,language:{url:"../js/DataTableSpanishShort2.json?"+vjs()}}),$("#Tabla_General").on("page.dt",(function(){CheckSesion(),e()}))})),$("#Total_General").on("shown.bs.modal",(function(){CheckSesion(),$("#table-Total_General").DataTable({drawCallback:function(a){$(".Fechas").html($("#_dr").val())},createdRow:function(a,e,s){$(a).addClass("animate__animated animate__fadeIn align-middle")},columnDefs:[{visible:!1,targets:0,type:"html"},{visible:!1,targets:4,type:"html"}],bProcessing:!0,ajax:{url:"Totales.php",dataSrc:"Horas",type:"POST",data:function(a){a._lega=$("#_lega").val(),a._dr=$("#_dr").val(),a.Tipo="Horas"}},columns:[{class:"",data:"Cod"},{class:"",data:"Descripcion"},{class:"text-center bg-light fw4 ls1",data:"HsAuto"},{class:"text-center ls1",data:"HsCalc"},{class:"text-center ls1",data:"HsHechas"},{class:"text-center ls1 w-100 text-white",data:"Cod"}],paging:0,searching:0,scrollCollapse:0,info:0,ordering:0,language:{url:"../js/DataTableSpanishShort2.json?"+vjs()}}),$("#table-Total_Novedades").DataTable({createdRow:function(a,e,s){$(a).addClass("animate__animated animate__fadeIn align-middle")},columnDefs:[{visible:!1,targets:0,type:"html"}],ajax:{url:"Totales.php",dataSrc:"Novedades",type:"POST",data:function(a){a._lega=$("#_lega").val(),a._dr=$("#_dr").val(),a.Tipo="Novedades"}},columns:[{class:"",data:"Cod"},{class:"",data:"Descripcion"},{class:"text-center bg-light fw4 ls1",data:"Horas"},{class:"text-center ls1",data:"Dias"},{class:"",data:"Tipo"},{class:"ls1 w-100 text-white",data:"Dias"}],paging:0,searching:0,scrollCollapse:0,info:0,ordering:0,language:{url:"../js/DataTableSpanishShort2.json?"+vjs()}}),$("#table-TotalNovTipo").DataTable({createdRow:function(a,e,s){$(a).addClass("animate__animated animate__fadeIn align-middle")},ajax:{url:"Totales.php",dataSrc:"NovTipo",type:"POST",data:function(a){a._lega=$("#_lega").val(),a._dr=$("#_dr").val(),a.Tipo="NovTipo"}},columns:[{class:"",data:"Descripcion"},{class:"text-center bg-light fw4 ls1",data:"Horas"},{class:"text-center ls1",data:"Dias"},{class:"text-center ls1 w-100 text-white",data:"Dias"}],paging:0,searching:0,scrollCollapse:0,info:0,ordering:0,language:{url:"../js/DataTableSpanishShort2.json?"+vjs()}})})),$("#Total_General").on("hide.bs.modal",(function(a){$("#table-Total_General").DataTable().clear().draw().destroy(),$("#table-Total_Novedades").DataTable().clear().draw().destroy(),$("#table-TotalNovTipo").DataTable().clear().draw().destroy()})),$(document).on("click",".open-modal",(function(a){CheckSesion(),a.preventDefault(),$("#modalGeneral").modal("show"),$("#Fichadas-tab").tab("show");var e=$(this).attr("data"),s=$(this).attr("data2"),l=$(this).attr("data3"),t=$(this).attr("data4"),n=$(this).attr("data5"),d=$(this).attr("data6");$(".nombre").html(s),$(".fecha").html(l),$(".dia").html(t),$(".horario").html(n),$(".datos_fichada").val(e),$(".datos_novedad").val(e),$(".datos_hora").val(e),$(".RegFech").val(d),$("#GetFichadas").DataTable({drawCallback:function(a){$.each(a.json,(function(a,e){e.length>0?$("#CantFic").html("("+e.length+")"):$("#CantFic").html("")}))},bProcessing:!0,deferRender:!0,ajax:{url:"GetFichadas.php",type:"GET",dataSrc:"Fichadas",data:{Datos:e}},columns:[{class:"align-middle ls1",data:"Fic"},{class:"align-middle",data:"Estado"},{class:"align-middle",data:"Tipo"},{class:"align-middle ls1",data:"Fecha"},{class:"align-middle ls1",data:"Original"},{class:"align-middle w-100",data:"null"}],paging:!1,scrollX:!1,scrollCollapse:!1,searching:!1,info:!1,ordering:!1,language:{url:"../js/DataTableSpanishShort2.json?"+vjs()}}),$("#GetNovedades").DataTable({drawCallback:function(a){$.each(a.json,(function(a,e){e.length>0?$("#CantNov").html("("+e.length+")"):$("#CantNov").html("")}))},bProcessing:!0,deferRender:!0,ajax:{url:"GetNovedades.php",type:"GET",dataSrc:"Novedades",data:{Datos:e}},columns:[{class:"align-middle ls1",data:"Cod"},{class:"align-middle",data:"Descripcion"},{class:"align-middle ls1 fw5",data:"Horas"},{class:"align-middle",data:"Obserb"},{class:"align-middle",data:"Causa"},{class:"align-middle",data:"Just"},{class:"align-middle",data:"Tipo"},{class:"align-middle",data:"Cate"},{class:"align-middle w-100",data:"null"}],paging:!1,scrollX:!1,scrollCollapse:!1,searching:!1,info:!1,ordering:!1,language:{url:"../js/DataTableSpanishShort2.json?"+vjs()}}),$("#GetHoras").DataTable({drawCallback:function(a){$.each(a.json,(function(a,e){if("Horas"==a&&(e.length>0?$("#CantHor").html("("+e.length+")"):$("#CantHor").html("")),"Fichas"==a){1==e.FicDiaL?($("#TextFicHsAT").html('<span class="text-dark d-none d-sm-block">Horas a Trabajar </span>'),$("#TextFicHsAT_M").html('<span class="text-dark d-block d-sm-none">A Trabajar </span>'),$("#FicHsAT").html(e.FicHsAT+"Hs."),$("#divHorasTR").removeClass("d-none")):($("#FicHsAT").html(""),$("#TextFicHsAT").html(""),$("#divHorasTR").addClass("d-none")),"00:00"!=e.FicHsTr?($("#TextFicHsTr").html('<span class="text-dark d-none d-sm-block">Horas Trabajadas </span>'),$("#TextFicHsTr_M").html('<span class="text-dark d-block d-sm-none">Trabajadas </span>'),$("#FicHsTr").html(e.FicHsTr+"Hs.")):($("#FicHsTr").html(""),$("#TextFicHsTr").html("")),$("#FicHorario").html(e.Horario),1==e.HorasNeg?$("#FicHsTr").addClass("text-danger"):$("#FicHsTr").removeClass("text-danger");var s=(s=e.FicHsTrMin/e.FicHsATMin*100).toFixed(),l=e.DatoFicha,t=e.FicHsTrMin>e.FicHsATMin?e.FicHsTrMin:e.FicHsATMin;if(e.FicHsTrMin>0&&e.FicHsTrMin<=e.FicHsATMin)$("#ProgressHoras").html('<div class="pb-2"><div class="progress border-0" style="height: 20px;"><div id="'+l+'" class="progress-bar" role="progressbar" style="width: '+s+'%;" aria-valuenow="'+e.FicHsTrMin+'" aria-valuemin="0" aria-valuemax="'+t+'">'+e.FicHsTr+"</div></div></div>"),e.FicHsTrMin<e.FicHsATMin?($("#"+l).addClass("bg-danger"),$("#"+l).removeClass("bg-custom")):($("#"+l).removeClass("bg-danger"),$("#"+l).addClass("bg-custom"));else if(e.FicHsTrMin>e.FicHsATMin){var n=100-(s=(s=e.FicHsATMin/e.FicHsTrMin*100).toFixed())+5,d=t;$("#ProgressHoras").html('<div class="pb-2"><div class="progress" style="height: 20px;"><div id="'+l+'" class="progress-bar" role="progressbar" style="width: '+s+'%;" aria-valuenow="'+e.FicHsTrMin+'" aria-valuemin="0" aria-valuemax="'+t+'">'+e.FicHsAT+'</div><div class="progress-bar bg-info" role="progressbar" style="width: '+n+'%;" aria-valuenow="'+e.FicHsTrMin+'" aria-valuemin="0" aria-valuemax="'+d+'"></div></div></div>'),e.FicHsTrMin<e.FicHsATMin?($("#"+l).addClass("bg-danger"),$("#"+l).removeClass("bg-custom")):($("#"+l).removeClass("bg-danger"),$("#"+l).addClass("bg-custom"))}else $("#ProgressHoras").html("")}}))},bProcessing:!0,deferRender:!0,ajax:{url:"GetHoras.php",type:"GET",dataSrc:"Horas",data:{Datos:e}},columns:[{class:"align-middle ls1",data:"Cod"},{class:"align-middle",data:"Descripcion"},{class:"align-middle ls1 fw5",data:"HsAuto"},{class:"align-middle ls1",data:"HsCalc"},{class:"align-middle ls1",data:"HsHechas"},{class:"align-middle w-100",data:"null"}],paging:!1,scrollX:!1,scrollCollapse:!1,searching:!1,info:!1,ordering:!1,language:{url:"../js/DataTableSpanishShort2.json?"+vjs()}})})),$("#modalGeneral").on("hidden.bs.modal",(function(){DestroyDataTablesModal()}));