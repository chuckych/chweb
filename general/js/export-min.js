$(document).ready((function(){function a(){$("#datoFicNovA").val("0"),$("#datoFicFalta").val("0"),$("#datoFicNovT").val("0"),$("#datoFicNovI").val("0"),$("#datoFicNovS").val("0"),$("#FicNovI").prop("checked",!1),$("#FicFalta").prop("checked",!1),$("#FicNovT").prop("checked",!1),$("#FicNovS").prop("checked",!1),$("#FicNovA").prop("checked",!1),$("#FicNovA").prop("disabled",!1),$("#FicFalta").prop("disabled",!1),$("#FicNovT").prop("disabled",!1),$("#FicNovI").prop("disabled",!1),$("#FicNovS").prop("disabled",!1)}function o(){$("#datoTotNove").val("0"),$("#TotNove").prop("checked",!1),$("#VerNove").prop("checked",!1),$("#datoVerNove").val("0")}function e(){$("#datoTotNove").val("1"),$("#TotNove").prop("checked",!0),$("#VerNove").prop("checked",!0),$("#datoVerNove").val("1")}function t(){$("#datoTotHoras").val("0"),$("#TotHoras").prop("checked",!1),$("#VerHoras").prop("checked",!1),$("#datoVerHoras").val("0")}function l(){$("#datoVerFic").val("0"),$("#VerFic").prop("checked",!1)}$(".select2").select2({minimumResultsForSearch:-1,placeholder:"Seleccionar"}),SelectSelect2(".select2Plantilla",!0,"Plantilla",0,-1,10,!1),$("#RangoDr").html($("#_dr").val()),$("#_dr").change((function(){$("#RangoDr").html($("#_dr").val())})),$(document).on("click","#FiltroReporte",(function(a){CheckSesion(),$(document).off("keydown"),a.preventDefault(),$("#Exportar").modal("hide"),$("#Filtros").modal("show")})),$(document).on("click","#ReporteFiltro",(function(a){$(document).off("keydown"),a.preventDefault(),$("#Filtros").modal("hide"),$("#Exportar").modal("show")})),$("#Exportar").on("shown.bs.modal",(function(){CheckSesion(),$("#_titulo").select(),$(document).off("keydown")})),$("#Exportar").on("hidden.bs.modal",(function(){})),$("#datoSaltoPag").val("0"),$("#SaltoPag").change((function(){$("#SaltoPag").is(":checked")?$("#datoSaltoPag").val("1"):$("#datoSaltoPag").val("0")})),$("#datoTotHoras").val("1"),$("#TotHoras").prop("checked",!0),$("#TotHoras").change((function(){$("#TotHoras").is(":checked")?$("#datoTotHoras").val("1"):$("#datoTotHoras").val("0")})),$("#datoTotNove").val("1"),$("#TotNove").prop("checked",!0),$("#TotNove").change((function(){$("#TotNove").is(":checked")?$("#datoTotNove").val("1"):$("#datoTotNove").val("0")})),$("#datoVerHoras").val("1"),$("#VerHoras").prop("checked",!0),$("#VerHoras").change((function(){$("#VerHoras").is(":checked")?($("#datoTotHoras").val("1"),$("#TotHoras").prop("checked",!0),$("#datoVerHoras").val("1")):($("#datoTotHoras").val("0"),$("#TotHoras").prop("checked",!1),$("#datoVerHoras").val("0"))})),$("#datoVerNove").val("1"),$("#VerNove").prop("checked",!0),$("#VerNove").change((function(){$("#VerNove").is(":checked")?($("#datoTotNove").val("1"),$("#TotNove").prop("checked",!0),$("#datoVerNove").val("1")):($("#datoTotNove").val("0"),$("#TotNove").prop("checked",!1),$("#datoVerNove").val("0"))})),$("#datoVerFic").val("1"),$("#VerFic").prop("checked",!0),$("#VerFic").change((function(){$("#VerFic").is(":checked")?$("#datoVerFic").val("1"):$("#datoVerFic").val("0")})),$("#_plantilla").on("select2:select",(function(r){"p_fic"==$("#_plantilla").val()?($("#_titulo").val("Reporte de Fichadas (Entrada y Salida)"),a(),$("#datoVerFic").val("1"),$("#VerFic").prop("checked",!0),o(),t()):"p_nov"==$("#_plantilla").val()?(a(),$("#_titulo").val("Reporte de Novedades"),e(),l(),t()):"p_hor"==$("#_plantilla").val()?(a(),$("#_titulo").val("Reporte de Horas"),$("#datoTotHoras").val("1"),$("#TotHoras").prop("checked",!0),$("#VerHoras").prop("checked",!0),$("#datoVerHoras").val("1"),l(),o()):"p_tar"==$("#_plantilla").val()?(a(),$("#_titulo").val("Reporte de Tardes"),$("#datoFicNovT").val("1"),$("#FicNovT").prop("checked",!0),$("#FicNovA").prop("disabled",!0),e(),l(),t()):"p_aus"==$("#_plantilla").val()?(a(),$("#_titulo").val("Reporte de Ausencias"),$("#datoFicNovA").val("1"),$("#FicNovA").prop("checked",!0),$("#FicFalta").prop("disabled",!0),$("#FicNovT").prop("disabled",!0),$("#FicNovI").prop("disabled",!0),$("#FicNovS").prop("disabled",!0),e(),l(),t()):"p_sal"==$("#_plantilla").val()?(a(),$("#_titulo").val("Reporte de Salidas Anticipadas"),$("#datoFicNovS").val("1"),$("#FicNovS").prop("checked",!0),$("#FicNovA").prop("disabled",!0),e(),l(),t()):"p_inc"==$("#_plantilla").val()&&(a(),$("#_titulo").val("Reporte de Incumplimientos"),$("#datoFicNovI").val("1"),$("#FicNovI").prop("checked",!0),$("#FicNovA").prop("disabled",!0),e(),l(),t())}));let r="Generar PDF";$("#FicDiaL").is(":checked");$(document).on("change","#FicDiaL",(function(a){c=$("#FicDiaL").is(":checked")?1:0}));let c=$("#FicDiaLFiltro").is(":checked")?1:0;$(document).on("change","#FicDiaLFiltro",(function(a){c=$("#FicDiaLFiltro").is(":checked")?1:0})),$("#btnExportar").html(r);document.getElementById("FormExportar").addEventListener("submit",(a=>{a.preventDefault(),CheckSesion();let o=new FormData;o.append("_l",$("#_l").val()),o.append("Filtros",_Filtros()),o.append("Per",null!=$("#Per").val()?$("#Per").val():""),o.append("Tipo",$("#Tipo").val()),o.append("Emp",null!=$("#Emp").val()?$("#Emp").val():""),o.append("Plan",null!=$("#Plan").val()?$("#Plan").val():""),o.append("Sect",null!=$("#Sect").val()?$("#Sect").val():""),o.append("Sec2",null!=$("#Sec2").val()?$("#Sec2").val():""),o.append("Grup",null!=$("#Grup").val()?$("#Grup").val():""),o.append("Sucur",null!=$("#Sucur").val()?$("#Sucur").val():""),o.append("_dr",$("#_dr").val()),o.append("FicDiaL",c),o.append("FicFalta",$("#datoFicFalta").val()),o.append("FicNovT",$("#datoFicNovT").val()),o.append("FicNovI",$("#datoFicNovI").val()),o.append("FicNovS",$("#datoFicNovS").val()),o.append("FicNovA",$("#datoFicNovA").val()),o.append("Fic3Nov",null!=$("#datoNovedad").val()?$("#Sucur").val():""),o.append("_VerFic",$("#VerFic").val()),o.append("_VerNove",$("#VerNove").val()),o.append("_VerHoras",$("#VerHoras").val()),o.append("_SaltoPag",$("#datoSaltoPag").val()),o.append("_destino",$("#_destino").val()),o.append("_orientation",$("#_orientation").val()),o.append("_nombre",$("#_nombre").val()),o.append("_titulo",$("#_titulo").val()),o.append("_watermark",$("#_watermark").val()),o.append("_format",$("#_format").val()),ActiveBTN(!0,"#btnExportar","Generando.!",r),$("#IFrame").addClass("d-none"),$("#Permisos").collapse("hide"),$.notifyClose();notify('Generando <span class = "dotting mr-1"> </span> <div class="spinner-border fontppp" role="status" style="width: 15px; height:15px" ></div>',"info",0,"right"),axios({method:"post",url:"reporte/index.php",data:o,headers:{"Content-Type":"multipart/form-data"}}).then((function(a){let o=a.data;if("V"==o.destino){$("#Exportar").modal("hide");var e=$("#_homehost").val(),t=$("#_host").val();window.open(t+"/"+e+"/general/reporte/archivos/"+o.archivo,"_blank"),$.notifyClose(),notify("Reporte Generado","success",2e3,"right"),ActiveBTN(!1,"#btnExportar","Generando.!",r)}else $("#IFrame").removeClass("d-none"),$("#IFrame").html(`<div class="col-12 pt-2"><iframe id="IframeID" src="reporte/archivos/${o.archivo}" width="100%" height="600" style="border:none;"></iframe></div>`),ActiveBTN(!1,"#btnExportar","Generando.!",r),$.notifyClose(),notify('<b>Reporte Generado correctamente</b>.<br><div class="shadow-sm w100"><a href="reporte/archivos/'+o.archivo+'" class="btn btn-custom px-3 btn-sm mt-2 fontq" target="_blank" download><div class="d-flex align-items-center"><span>Descargar</span><i class="bi bi-file-earmark-arrow-down ml-1 font1"></i></div></a></div>',"warning",0,"right")})).catch((function(a){ActiveBTN(!1,"#btnExportar","Generando.!",r),$.notifyClose(),notify(`${data.Mensaje}`,"danger",5e3,"right")}))}))}));