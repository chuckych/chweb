var loading = '<div class="spinner-border fontppp" role="status" style="width: 15px; height:15px" ></div>', maskBehavior = function (a) { return a = a.split(":"), parseInt(a[0]) > 19 ? "HZ:M0" : "H0:M0" }; function OcultaNavTab() { "1" == $("#Mxs").val() && ($("#nav-tab").hide(), $("#nav-tabContent").addClass("border")) } function MuestraNavTab() { "1" == $("#Mxs").val() && ($("#nav-tab").show(), $("#nav-tabContent").removeClass("border")) } function DestroyDataTablesModal() { $("#GetFichadas").DataTable().clear().draw().destroy(), $("#GetNovedades").DataTable().clear().draw().destroy(), $("#GetHoras").DataTable().clear().draw().destroy(), $("#GetOtrasNov").DataTable().clear().draw().destroy() } function ClearFormNov() { $(".Form_Novedad").addClass("d-none"), $(".respuesta_Novedades").html(""), $(".Form_Novedad_Mod").addClass("d-none"), $(".FicHoras").val("00:00"), $(".respuesta_novedad").html(""), $(".selectjs_Novedades").val(null).trigger("change"), $(".selectjs_NoveCausa").val(null).trigger("change"), $("#FicObse").val(""), $("#FicJust").prop("checked", !1), $("#FicCate").prop("checked", !1), $("#FicCate").prop("disabled", !1), $("#xsTNov").html("Novedades") } function ClearFormFic() { $(".Form_Fichadas").addClass("d-none"), $(".respuesta_fichada").html(""), $(".Form_Fichadas_Mod").addClass("d-none"), $(".RegHora").val(""), $(".respuesta_fichada").html(""), $(".respuesta_fichada_mod").html(""), $(".respuesta_baja_fichada").addClass("d-none"), $("#xsTFic").html("Fichadas") } function ClearFormHora() { $(".Form_Horas").addClass("d-none"), $(".respuesta_Horas").html(""), $("#Fic1HsAu2").val("00:00"), $(".selectjs_TipoHora").val(null).trigger("change"), $(".selectjs_MotivoHora").val(null).trigger("change"), $("#Fic1Observ").val(""), $("#xsTHor").html("Horas") } function ClearFormONov() { $(".Form_OtraNovedad").addClass("d-none"), $(".respuesta_OtrasNov").html(""), $("#alta_OtrasNov").val("true").trigger("change"), $("#FicValor").val(null).trigger("change"), $(".selectjs_OtrasNovedades").val(null).trigger("change"), $("#FicObsN").val(null).trigger("change"), $("#xsTOnov").html("Otras Novedades") } function ClearFormCitacion() { $("#rowCitacion").addClass("d-none"), $(".respuesta_Citacion").html(""), $("#alta_Citación").val("true"), $("#CitEntra").val(), $("#CitSale").val(), $("#CitDesc").val("00:00"), $("#rowCitacion").removeClass("animate__animated animate__fadeIn"), $(".submit_btn_Citación").prop("disabled", !1), $("#modalGeneral").modal("hide") } function getHorarioActual(a, e, t) { $.ajax({ dataType: "json", type: "POST", url: "../op/horarios/getHorario.php", data: { Legajo: a, Fecha: e }, success: function (a) { "ok" == a.status ? $("#FicHorario").html('<span class="animate__animated animate__fadeIn">' + a.Mensaje + "</span>") : $("#FicHorario").html('<span class="">Horario: ' + t + "</span>") }, error: function (a) { $("#FicHorario").html('<span class="">Horario: ' + t + "</span>") } }) } spOptions = { onKeyPress: function (a, e, t, o) { t.mask(maskBehavior.apply({}, arguments), o) }, translation: { H: { pattern: /[0-2]/, optional: !1 }, Z: { pattern: /[0-3]/, optional: !1 }, M: { pattern: /[0-5]/, optional: !1 } } }, $(".HoraMask").mask(maskBehavior, spOptions), onOpenSelect2(), $("#ProcesarLegajo").attr("disabled", !1), $("#ProcesarLegajo").html("Procesar"), $("#_range").prop("checked", !0), $("#divRangofecha").addClass("d-none"), $("#PagDia").addClass("d-none"), $("#_dl").prop("checked", !0), $("#PagDia").addClass("invisible"), $("#Total_dia").addClass("d-none"), $(document).on("click", "#_dl", (function () { CheckSesion(), $("#_dl").is(":checked") ? ($("#_dl").val("on").trigger("change"), $("#GetGeneral").DataTable().ajax.reload(null, !1)) : ($("#_dl").val("off").trigger("change"), $("#GetGeneral").DataTable().ajax.reload(null, !1)) })), $(document).on("click", "#FullScreen", (function () { CheckSesion(), $("#container").removeClass("container"), $("#container").addClass("container-fluid"), $("#FullScreen").addClass("d-none"), $("#GetGeneral").addClass("w-100"), $("#NormalScreen").removeClass("d-none"), $("#GetGeneral").removeClass("text-wrap"), $("#GetGeneral").addClass("text-nowrap"), $("#GetGeneral").DataTable().ajax.reload(null, !1) })), $(document).on("click", "#NormalScreen", (function () { CheckSesion(), $("#container").removeClass("container-fluid"), $("#container").addClass("container"), $("#GetGeneral").removeClass("w-auto"), $("#GetGeneral").addClass("w-100"), $("#GetGeneral").addClass("text-wrap"), $("#GetGeneral").removeClass("text-nowrap"), $("#FullScreen").removeClass("d-none"), $("#NormalScreen").addClass("d-none"), $("#GetGeneral").DataTable().ajax.reload(null, !1) })), $(document).on("click", "#_range", (function () { CheckSesion(), $("#_range").is(":checked") ? ($("#_range").val("on"), $("#Total_dia").addClass("d-none"), $("#GetGeneral").DataTable().ajax.reload(null, !1), $("#PagDia").addClass("invisible")) : ($("#_range").val("off"), $("#Total_dia").removeClass("d-none"), $("#GetGeneral").DataTable().ajax.reload(null, !1), $("#PagDia").removeClass("invisible")) })), $(document).on("click", "#ProcesarTodo", (function (a) { a.preventDefault(), CheckSesion(), $.ajax({ type: "POST", dataType: "text", url: "procesar.php?Inicio=" + FechaIni + "&Fin=" + FechaFin, beforeSend: function () { $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), $("#ProcesarTodo").attr("disabled", !0) }, success: function (a, e, t) { if ($("#ProcesarTodo").attr("disabled", !1), $("#ProcesarTodo").html("Procesar"), "Terminado" == a) var o = "Datos Procesados"; else o = `Error<br> ${a}</span>`; $("#GetGeneral").DataTable().ajax.reload(null, !1), $.notifyClose(), notify(o, "success", 5e3, "right") }, error: function (a, e, t) { $("#ProcesarTodo").attr("disabled", !1), $("#ProcesarTodo").html("Procesar"), $.notifyClose(), notify("Error", "danger", 5e3, "right") } }) })), $(document).ready((function () { $("#Total_General").on("shown.bs.modal", (function (a) { $("#table-Total_General").DataTable({ bProcessing: !0, ajax: { url: host + "/?p=array_general_totales.php&FechaIni=" + FechaIni + "&FechaFin=" + FechaFin + "&" + QueryString, dataSrc: "Horas", type: "GET", data: function (a) { a._c = $("#_c").val(), a._r = $("#_r").val(), a._dl = $("input[name=_dl]:checked").val(), a._range = $("input[name=_range]:checked").val() } }, columns: [{ class: "", data: "Cod" }, { class: "", data: "Descripcion" }, { class: "text-center bg-light fw4 ls1", data: "HsAuto" }, { class: "text-center ls1", data: "HsCalc" }, { class: "text-center ls1", data: "HsHechas" }, { class: "text-center ls1 w-100 text-white", data: "Cod" }], paging: !1, searching: !1, scrollCollapse: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }), $("#table-Total_Novedades").DataTable({ ajax: { url: host + "/?p=array_general_totales.php&FechaIni=" + FechaIni + "&FechaFin=" + FechaFin + "&" + QueryString, dataSrc: "Novedades", type: "GET", data: function (a) { a._c = $("#_c").val(), a._r = $("#_r").val(), a._dl = $("input[name=_dl]:checked").val(), a._range = $("input[name=_range]:checked").val() } }, columns: [{ class: "", data: "Cod" }, { class: "", data: "Descripcion" }, { class: "text-center bg-light fw4 ls1", data: "Horas" }, { class: "text-center ls1", data: "Dias" }, { class: "", data: "Tipo" }, { class: "ls1 w-100 text-white", data: "Dias" }], paging: !1, searching: !1, scrollCollapse: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }), $("#table-TotalNovTipo").DataTable({ ajax: { url: host + "/?p=array_general_totales.php&FechaIni=" + FechaIni + "&FechaFin=" + FechaFin + "&" + QueryString, dataSrc: "NovTipo", type: "GET", data: function (a) { a._c = $("#_c").val(), a._r = $("#_r").val(), a._dl = $("input[name=_dl]:checked").val(), a._range = $("input[name=_range]:checked").val() } }, columns: [{ class: "", data: "Descripcion" }, { class: "text-center bg-light fw4 ls1", data: "Horas" }, { class: "text-center ls1", data: "Dias" }, { class: "text-center ls1 w-100 text-white", data: "Dias" }], paging: !1, searching: !1, scrollCollapse: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }) })), $("#Total_General").on("hide.bs.modal", (function (a) { $("#table-Total_General").DataTable().clear().draw().destroy(), $("#table-Total_Novedades").DataTable().clear().draw().destroy(), $("#table-TotalNovTipo").DataTable().clear().draw().destroy() })), $("#Total_pdia").on("shown.bs.modal", (function (a) { $("#table-Total_General_Dia").DataTable({ ajax: { url: host + "/?p=array_general_totales.php&FechaIni=" + FechaIni + "&FechaFin=" + FechaFin + "&" + QueryString + "&dia=" + diaString, dataSrc: "Horas", type: "GET", data: function (a) { a._c = $("#_c").val(), a._r = $("#_r").val(), a._dl = $("input[name=_dl]:checked").val(), a._range = $("input[name=_range]:checked").val() } }, columns: [{ class: "", data: "Cod" }, { class: "", data: "Descripcion" }, { class: "text-center bg-light fw4 ls1", data: "HsAuto" }, { class: "text-center ls1", data: "HsCalc" }, { class: "text-center ls1", data: "HsHechas" }, { class: "text-center ls1 w-100 text-white", data: "Cod" }], paging: !1, searching: !1, scrollCollapse: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }), $("#table-Total_Nov_Dia").DataTable({ ajax: { url: host + "/?p=array_general_totales.php&FechaIni=" + FechaIni + "&FechaFin=" + FechaFin + "&" + QueryString + "&dia=" + diaString, dataSrc: "Novedades", type: "GET", data: function (a) { a._c = $("#_c").val(), a._r = $("#_r").val(), a._dl = $("input[name=_dl]:checked").val(), a._range = $("input[name=_range]:checked").val() } }, columns: [{ class: "", data: "Cod" }, { class: "", data: "Descripcion" }, { class: "text-center bg-light fw4 ls1", data: "Horas" }, { class: "text-center ls1", data: "Dias" }, { class: "", data: "Tipo" }, { class: "ls1 w-100 text-white", data: "Dias" }], paging: !1, searching: !1, scrollCollapse: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }), $("#table-Total_Nov_Tipo_Dia").DataTable({ ajax: { url: host + "/?p=array_general_totales.php&FechaIni=" + FechaIni + "&FechaFin=" + FechaFin + "&" + QueryString + "&dia=" + diaString, dataSrc: "NovTipo", type: "GET", data: function (a) { a._c = $("#_c").val(), a._r = $("#_r").val(), a._dl = $("input[name=_dl]:checked").val(), a._range = $("input[name=_range]:checked").val() } }, columns: [{ class: "", data: "Tipo" }, { class: "", data: "Descripcion" }, { class: "text-center bg-light fw4 ls1", data: "Horas" }, { class: "text-center ls1", data: "Dias" }, { class: "text-center ls1 w-100 text-white", data: "Dias" }], paging: !1, searching: !1, scrollCollapse: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }) })), $("#Total_pdia").on("hide.bs.modal", (function (a) { $("#table-Total_General_Dia").DataTable().clear().draw().destroy(), $("#table-Total_Nov_Dia").DataTable().clear().draw().destroy(), $("#table-Total_Nov_Tipo_Dia").DataTable().clear().draw().destroy() })) })), $(document).on("click", "#AddFic", (function (a) { CheckSesion(), ClearFormFic(), $(".Form_Fichadas").removeClass("d-none"), $(".Form_Fichadas").addClass("animate__animated animate__fadeIn"), $(".submit_btn").prop("disabled", !1), fadeInOnly("#RegHora"), $("#RegHora").select(), OcultaNavTab(), $("#xsTFic").html("Agregar Fichada") })), $(document).on("click", "#AddNov", (function (a) { CheckSesion(), ClearFormNov(), $(".Form_Novedad").removeClass("d-none"), $(".Form_Novedad").addClass("animate__animated animate__fadeIn"), $("#alta_novedad").val("true"), $("#FicCate").prop("disabled", !1), $(".submit_btn_mod").html("Agregar"), $("#novTipo").val("").trigger("change"), $(".submit_btn_mod").prop("disabled", !1), $(".selectjs_Novedades").select2("open"), OcultaNavTab(), $("#xsTNov").html("Agregar Novedad") })), $(document).on("click", "#AddHora", (function (a) { CheckSesion(), ClearFormHora(), $("#modHora").val("0").trigger("change"), $(".Form_Horas").removeClass("d-none"), $(".Form_Horas").addClass("animate__animated animate__fadeIn"), $("#alta_horas").val("true").trigger("change"), $(".submit_btn_HorMod").html("Agregar"), $("#cancelar_btn_hor").html("Cancelar"), $(".submit_btn_HorMod").prop("disabled", !1), $(".selectjs_TipoHora").select2("open"), OcultaNavTab(), $("#xsTHor").html("Agregar Horas") })), $(document).on("click", "#AddONov", (function (a) { CheckSesion(), ClearFormONov(), $(".Form_OtraNovedad").removeClass("d-none"), $(".Form_OtraNovedad").addClass("animate__animated animate__fadeIn"), $(".submit_btn_OtrasNov").html("Agregar"), $(".submit_btn_OtrasNov").prop("disabled", !1), $(".selectjs_OtrasNovedades").select2("open"), OcultaNavTab(), $("#xsTOnov").html("Agregar Novedad") })), $(document).on("click", ".cancelar_btn_fic", (function (a) { CheckSesion(), ClearFormFic() })), $(document).on("click", ".cancelar_btn_nov", (function (a) { CheckSesion(), ClearFormNov(), $("#novCate").val("2").trigger("change") })), $(document).on("click", "#cancelar_btn_hor", (function (a) { CheckSesion(), ClearFormHora() })), $(document).on("click", "#cancelar_btn_OtrasNov", (function (a) { CheckSesion(), ClearFormONov() })), $(document).on("click", "#cancelar_btn_Citación", (function (a) { CheckSesion(), ClearFormCitacion() })), $(document).on("click", ".procReg", (function (a) { CheckSesion(), $(this).parents("tr td").addClass("text-info"), $(this).removeClass("procReg"), a.preventDefault(); let e = $(this).attr("data-nombre"), t = $(this).attr("data-lega"), o = $(this).attr("data-fechaini"), n = $(this).attr("data-fechafin"), s = $(this).attr("data-procLega"); $.ajax({ type: "POST", dataType: "json", url: "../procesar/procesando.php", data: { procesaLegajo: s, nombreLegajo: e, procesando: !0, ProcLegaIni: t, ProcLegaFin: t, ProcFechaIni: o, ProcFechaFin: n }, beforeSend: function () { $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right") }, success: function (a) { "ok" == a.status ? ($(this).addClass("procReg"), ActualizaTablas(), $.notifyClose(), notify(a.Mensaje, "success", 3e3, "right")) : ($.notifyClose(), ActualizaTablas(), $(this).addClass("procReg"), notify(a.Mensaje, "danger", 3e3, "right")) } }) })), $(".Filtros").on("click", (function () { CheckSesion() })), $(document).on("click", ".open-modal", (function (a) { a.preventDefault(), $("#modalGeneral").modal("show"), $(document).off("keydown"), CheckSesion(), $.notifyClose(), $("#modalGeneral").modal("handleUpdate"), $(".navbar").addClass("mr-0"), $("#Fichadas-tab").tab("show"), $("#AddHora").addClass("d-none"), $("#AddNov").addClass("d-none"), $("#AddONov").addClass("d-none"), $("#Horas").addClass("d-none"), $("#Novedades").addClass("d-none"), $("#OtrasNov").addClass("d-none"), $("#FicValor").mask("##.##00.00", { reverse: !0 }); var e = $(this).attr("data"), t = $(this).attr("data2"), o = $(this).attr("data3"), n = $(this).attr("data4"), s = $(this).attr("data5"), r = $(this).attr("data6"), i = (r = $(this).attr("data6"), $(this).attr("dataFechDR")), l = $(this).attr("data7"), d = $(this).attr("data_mFic"), c = $(this).attr("data_mHor"), u = $(this).attr("data_mNov"), m = e.split("-"); function h() { $.ajax({ type: "GET", dataType: "json", url: "../data/GetCierre.php", data: { Datos: $("#data").val() }, success: function (a) { "ok" == a.status ? ($("#FechCierre").html('Cierre: <span class="ls1 fw5 ml-1">' + a.dato + "</span>"), $("#AddHora").prop("disabled", !0), $("#AddONov").prop("disabled", !0), $("#AddFic").prop("disabled", !0), $("#AddNov").prop("disabled", !0), $(".mod_Fic").prop("disabled", !0), $("#FicHorario").addClass("mt-1"), $("#Citacion").prop("disabled", !0), $("#Citacion").hide()) : ($("#FechCierre").html(""), $("#AddHora").prop("disabled", !1), $("#AddONov").prop("disabled", !1), $("#AddFic").prop("disabled", !1), $("#AddNov").prop("disabled", !1), $("#Citacion").prop("disabled", !1), $("#Citacion").show(), $("#FicHorario").removeClass("mt-1")) }, error: function () { } }) } function g() { $.ajax({ type: "GET", dataType: "json", url: "GetFichas2.php", data: { Datos: $("#data").val() }, success: function (a) { getHorarioActual(m[0], m[1], a.FicHorario), $("#FicHsTr").html(a.FicHsTr + "Hs."), 1 == a.FicDiaL ? ($("#TextFicHsAT").html('<span class="text-dark d-none d-sm-block">Horas a Trabajar </span>'), $("#TextFicHsAT_M").html('<span class="text-dark d-block d-sm-none">A Trabajar </span>'), $("#FicHsAT").html(a.FicHsAT + "Hs."), $("#divHorasTR").removeClass("d-none")) : ($("#FicHsAT").html(""), $("#TextFicHsAT").html(""), $("#divHorasTR").addClass("d-none")), "00:00" != a.FicHsTr ? ($("#TextFicHsTr").html('<span class="text-dark d-none d-sm-block">Horas Trabajadas </span>'), $("#TextFicHsTr_M").html('<span class="text-dark d-block d-sm-none">Trabajadas </span>')) : ($("#FicHsTr").html(""), $("#TextFicHsTr").html("")) }, error: function () { } }) } function p() { $.ajax({ type: "GET", dataType: "json", url: "GetCitacion.php", data: { Datos: $("#data").val() }, beforeSend: function () { }, success: function (a) { 0 != a.CitEntra ? $("#bCit").show() : $("#bCit").hide(), 0 != a.CitEntra ? $("#bCit").attr("datos", $("#data").val()) : $("#bCit").attr("datos", ""), 0 != a.CitEntra ? $("#CitEntra").val(a.CitEntra) : $("#CitEntra").val(), 0 != a.CitSale ? $("#CitSale").val(a.CitSale) : $("#CitSale").val(), 0 != a.CitDesc ? $("#CitDesc").val(a.CitDesc) : $("#CitDesc").val() }, error: function () { $("#CitEntra").val(), $("#CitSale").val(), $("#CitDesc").val("00:00") } }) } $("#FicHorario").html("Horario: " + s), $("#NombreLega").val(t), "1" == d && ($("#Mxs").val("1"), $(".nav").addClass("d-none"), Modal_XL_LG("#TopN"), $("#Fichadas").removeClass("border-top-0")), "1" == c && ($("#Mxs").val("1"), $(".nav").addClass("d-none"), $("#Horas-tab").tab("show"), Modal_XL_LG("#TopN"), $("#Horas").removeClass("border-top-0")), "1" == u && ($("#Mxs").val("1"), $(".nav").addClass("d-none"), $("#Novedades-tab").tab("show"), Modal_XL_LG("#TopN"), $("#Novedades").removeClass("border-top-0")), $("#Fichadas-tab").on("shown.bs.tab", (function (a) { $("#Fichadas").removeClass("d-none"), $("#Horas").addClass("d-none"), $("#Novedades").addClass("d-none"), $("#OtrasNov").addClass("d-none") })), $("#Novedades-tab").on("shown.bs.tab", (function (a) { $("#Novedades").removeClass("d-none"), $("#Fichadas").addClass("d-none"), $("#Horas").addClass("d-none"), $("#OtrasNov").addClass("d-none") })), $("#Horas-tab").on("shown.bs.tab", (function (a) { $("#Horas").removeClass("d-none"), $("#Novedades").addClass("d-none"), $("#Fichadas").addClass("d-none"), $("#OtrasNov").addClass("d-none") })), $("#OtrasNov-tab").on("shown.bs.tab", (function (a) { $("#OtrasNov").removeClass("d-none"), $("#Horas").addClass("d-none"), $("#Novedades").addClass("d-none"), $("#Fichadas").addClass("d-none") })), $("#data").val(e), $(".nombre").html(t), $(".NumLega").html(m[0]), $(".legajo").html("Legajo: " + m[0]), $(".fecha").html(o), $(".dia").html('<span class="ls1">' + n + "</span>"), $(".datos_fichada").val(e), $(".datos_novedad").val(e), $(".datos_hora").val(e), $(".datos_OtrasNov").val(e), $(".datos_Citacion").val(e), singleDatePicker("#RegFech_Fichada", "center", "down"), $("#RegFech_Fichada").data("daterangepicker").setStartDate(i), $("#RegFech_Fichada").data("daterangepicker").setEndDate(i), $("#ProcesarLegajo").on("click", (function () { CheckSesion(), $.ajax({ type: "POST", dataType: "json", url: "../procesar/procesando.php", data: { procesaLegajo: !0, nombreLegajo: t, procesando: !0, ProcLegaIni: m[0], ProcLegaFin: m[0], ProcFechaIni: r, ProcFechaFin: r }, beforeSend: function () { $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), _() }, success: function (a) { "ok" == a.status ? (F(), T(), $.notifyClose(), notify(a.Mensaje, "success", 5e3, "right")) : (F(), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right")) } }) })), h(), g(), p(), $("#GetFichadas").DataTable({ initComplete: function (a, e) { }, drawCallback: function (a) { $.each(a.json, (function (a, e) { e.length > 0 ? $("#CantFic").html("(" + e.length + ")") : $("#CantFic").html("") })) }, bProcessing: !0, deferRender: !0, ajax: { url: "GetFichadas.php", type: "GET", dataSrc: "Fichadas", data: { Datos: e } }, columns: [{ class: "align-middle ls1 py-3", data: "Fic" }, { class: "align-middle", data: "editar" }, { class: "align-middle", data: "eliminar" }, { class: "align-middle", data: "Estado" }, { class: "align-middle", data: "Tipo" }, { class: "align-middle ls1", data: "Fecha" }, { class: "align-middle ls1", data: "Original" }, { class: "align-middle w-100", data: "null" }], paging: !1, scrollX: !1, scrollCollapse: !1, searching: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }), $("#GetNovedades").DataTable({ drawCallback: function (a) { $.each(a.json, (function (a, e) { e.length > 0 ? $("#CantNov").html("(" + e.length + ")") : $("#CantNov").html("") })) }, bProcessing: !0, deferRender: !0, ajax: { url: "GetNovedades.php", type: "GET", dataSrc: "Novedades", data: { Datos: e } }, columns: [{ class: "align-middle ls1 py-3", data: "Cod" }, { class: "align-middle", data: "Descripcion" }, { class: "align-middle ls1", data: "Horas" }, { class: "align-middle ", data: "editar" }, { class: "align-middle ", data: "eliminar" }, { class: "align-middle", data: "Obserb" }, { class: "align-middle", data: "Causa" }, { class: "align-middle", data: "Just" }, { class: "align-middle", data: "Tipo" }, { class: "align-middle", data: "Cate" }, { class: "align-middle w-100", data: "null" }], paging: !1, scrollX: !1, scrollCollapse: !1, searching: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }), $("#GetHoras").DataTable({ bProcessing: !0, deferRender: !0, ajax: { url: "GetHoras.php", type: "GET", dataSrc: "Horas", data: { Datos: e } }, columns: [{ class: "align-middle ls1 py-3", data: "Cod" }, { class: "align-middle", data: "Descripcion" }, { class: "align-middle ls1", data: "HsAuto" }, { class: "align-middle ls1", data: "HsCalc" }, { class: "align-middle", data: "editar" }, { class: "align-middle", data: "eliminar" }, { class: "align-middle", data: "DescMotivo" }, { class: "align-middle", data: "Observ" }, { class: "align-middle w-100", data: "null" }], paging: !1, scrollX: !1, scrollCollapse: !1, searching: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }), $("#GetHoras").on("draw.dt", (function (a, e) { return $.each(e.json, (function (a, e) { if ("Horas" == a && (e.length > 0 ? $("#CantHor").html("(" + e.length + ")") : $("#CantHor").html("")), "Fichas" == a) { var t = (t = e.FicHsTrMin / e.FicHsATMin * 100).toFixed(), o = e.DatoFicha, n = e.FicHsTrMin > e.FicHsATMin ? e.FicHsTrMin : e.FicHsATMin; if (e.FicHsTrMin > 0 && e.FicHsTrMin <= e.FicHsATMin) $("#ProgressHoras").html('<div class="pb-2"><div class="progress border-0" style="height: 20px;"><div id="' + o + '" class="progress-bar" role="progressbar" style="width: ' + t + '%;" aria-valuenow="' + e.FicHsTrMin + '" aria-valuemin="0" aria-valuemax="' + n + '">' + e.FicHsTr + "</div></div></div>"), e.FicHsTrMin < e.FicHsATMin ? ($("#" + o).addClass("bg-danger"), $("#" + o).removeClass("bg-custom")) : ($("#" + o).removeClass("bg-danger"), $("#" + o).addClass("bg-custom")); else if (e.FicHsTrMin > e.FicHsATMin) { var s = 100 - (t = (t = e.FicHsATMin / e.FicHsTrMin * 100).toFixed()) + 5, r = n; $("#ProgressHoras").html('<div class="pb-2"><div class="progress" style="height: 20px;"><div id="' + o + '" class="progress-bar" role="progressbar" style="width: ' + t + '%;" aria-valuenow="' + e.FicHsTrMin + '" aria-valuemin="0" aria-valuemax="' + n + '">' + e.FicHsAT + '</div><div class="progress-bar bg-info" role="progressbar" style="width: ' + s + '%;" aria-valuenow="' + e.FicHsTrMin + '" aria-valuemin="0" aria-valuemax="' + r + '"></div></div></div>'), e.FicHsTrMin < e.FicHsATMin ? ($("#" + o).addClass("bg-danger"), $("#" + o).removeClass("bg-custom")) : ($("#" + o).removeClass("bg-danger"), $("#" + o).addClass("bg-custom")) } else $("#ProgressHoras").html("") } })), !1 })), $("#GetOtrasNov").DataTable({ drawCallback: function (a) { $.each(a.json, (function (a, e) { e.length > 0 ? $("#CantONov").html("(" + e.length + ")") : $("#CantONov").html("") })) }, bProcessing: !0, deferRender: !0, ajax: { url: "GetOtrasNovedades.php", type: "GET", dataSrc: "ONovedades", data: { Datos: e } }, columns: [{ class: "align-middle text-center py-3", data: "Cod" }, { class: "align-middle", data: "Descripcion" }, { class: "align-middle ls1 text-right", data: "FicValor" }, { class: "align-middle", data: "Observ" }, { class: "align-middle", data: "editar" }, { class: "align-middle", data: "eliminar" }, { class: "align-middle", data: "Tipo" }, { class: "align-middle w-100", data: "null" }], paging: !1, scrollX: !1, scrollCollapse: !1, searching: !1, info: !1, ordering: !1, language: { url: "../js/DataTableSpanish.json" } }); var f = 0, v = 0, b = 0, C = 250; function _() { $("#CierraModalGeneral").prop("disabled", !0), $("#CierraModalGeneral").html("Procesando"), $("#ProcesarLegajo").prop("disabled", !0), $("#ProcesarLegajo").html("Procesando") } function F() { $("#ProcesarLegajo").attr("disabled", !1), $("#ProcesarLegajo").html("Procesar"), $("#CierraModalGeneral").prop("disabled", !1), $("#CierraModalGeneral").html("Cerrar"), $(".respuesta_fichada").html(""), $(".submit_btn").prop("disabled", !1), $(".submit_btn_mod").prop("disabled", !1), $(".respuesta_novedad").html("") } function T() { F(), $("#GetFichadas").DataTable().ajax.reload(null, !1), $("#GetNovedades").DataTable().ajax.reload(null, !1), $("#GetHoras").DataTable().ajax.reload(null, !1), $("#GetOtrasNov").DataTable().ajax.reload(null, !1), ActualizaTablas(), h(), g(), p() } $(".selectjs_Novedades").select2({ dropdownAutoHeight: !0, multiple: !1, language: "es", allowClear: !0, placeholder: "Seleccionar Novedad", minimumInputLength: f, minimumResultsForSearch: 10, maximumInputLength: b, selectOnClose: v, language: { noResults: function () { return "No hay resultados.." }, inputTooLong: function (a) { var e = "Máximo " + b + " caracteres. Elimine " + overChars + " caracter"; return 1 != overChars && (e += "es"), e }, searching: function () { return "Buscando.." }, errorLoading: function () { return "Sin datos.." }, inputTooShort: function () { return "Ingresar " + f + " o mas caracteres" }, maximumSelected: function () { return "Puede seleccionar solo una opción" }, removeAllItems: function () { return "Borrar" } }, ajax: { url: "../data/getListNovedades.php", dataType: "json", type: "POST", delay: C, data: function (a) { return { q: a.term, _nt: $("#novTipo").val(), _nc: $("#novCate").val(), Datos: e } }, processResults: function (a) { return { results: a } } } }), $(".selectjs_Novedades").on("select2:select", (function (a) { $("#FicNove").val($(this).val()), $(".selectjs_NoveCausa").val(null).trigger("change"), $("#FicHoras").focus(), "" != $("#FicHoras").val() && $("#FicHoras").select() })), $(".selectjs_Novedades").on("select2:unselecting", (function (a) { $(".selectjs_NoveCausa").val(null).trigger("change") })), $(".selectjs_NoveCausa").select2({ multiple: !1, language: "es", allowClear: !0, placeholder: "Seleccionar Causa", minimumInputLength: f, minimumResultsForSearch: 10, maximumInputLength: b, selectOnClose: v, language: { noResults: function () { return "No hay resultados.." }, inputTooLong: function (a) { var e = "Máximo " + b + " caracteres. Elimine " + overChars + " caracter"; return 1 != overChars && (e += "es"), e }, searching: function () { return "Buscando.." }, errorLoading: function () { return "Sin datos.." }, inputTooShort: function () { return "Ingresar " + f + " o mas caracteres" }, maximumSelected: function () { return "Puede seleccionar solo una opción" }, removeAllItems: function () { return "Borrar" } }, ajax: { url: "../data/getListNoveCausa.php", dataType: "json", type: "POST", delay: C, data: function (a, e) { return { q: a.term, NovCNove: $("#FicNove").val() } }, processResults: function (a) { return { results: a } } } }), $(".selectjs_TipoHora").select2({ multiple: !1, language: "es", placeholder: "Seleccionar Tipo Hora", minimumInputLength: f, minimumResultsForSearch: 10, maximumInputLength: b, selectOnClose: v, language: { noResults: function () { return "No hay resultados.." }, inputTooLong: function (a) { var e = "Máximo " + b + " caracteres. Elimine " + overChars + " caracter"; return 1 != overChars && (e += "es"), e }, searching: function () { return "Buscando.." }, errorLoading: function () { return "Sin datos.." }, inputTooShort: function () { return "Ingresar " + f + " o mas caracteres" }, maximumSelected: function () { return "Puede seleccionar solo una opción" }, removeAllItems: function () { return "Borrar" } }, ajax: { url: "../data/getListTipoHora.php", dataType: "json", type: "POST", delay: C, data: function (a, t) { return { q: a.term, Datos: e, modHora: $("#modHora").val(), THoCodi: $(".selectjs_TipoHora").val() } }, processResults: function (a) { return { results: a } } } }), $(".selectjs_MotivoHora").select2({ multiple: !1, language: "es", allowClear: !0, placeholder: "Seleccionar Motivo", minimumInputLength: f, minimumResultsForSearch: 10, maximumInputLength: b, selectOnClose: v, language: { noResults: function () { return "No hay resultados.." }, inputTooLong: function (a) { var e = "Máximo " + b + " caracteres. Elimine " + overChars + " caracter"; return 1 != overChars && (e += "es"), e }, searching: function () { return "Buscando.." }, errorLoading: function () { return "Sin datos.." }, inputTooShort: function () { return "Ingresar " + f + " o mas caracteres" }, maximumSelected: function () { return "Puede seleccionar solo una opción" }, removeAllItems: function () { return "Borrar" } }, ajax: { url: "../data/getListMotivoHora.php", dataType: "json", type: "POST", delay: C, data: function (a, e) { return { q: a.term, Fic1Hora: $("#Fic1Hora").val() } }, processResults: function (a) { return { results: a } } } }), $(".selectjs_TipoHora").on("select2:select", (function (a) { $("#Fic1Hora").val($(this).val()), $(".selectjs_MotivoHora").val(null).trigger("change"), $("#Fic1HsAu2").focus(), "" != $("#Fic1HsAu2").val() && $("#Fic1HsAu2").select() })), $(".selectjs_TipoHora").on("select2:unselecting", (function (a) { $(".selectjs_MotivoHora").val(null).trigger("change") })), $(".selectjs_OtrasNovedades").select2({ dropdownAutoHeight: !0, multiple: !1, language: "es", allowClear: !0, placeholder: "Seleccionar Novedad", minimumInputLength: f, minimumResultsForSearch: 10, maximumInputLength: b, selectOnClose: v, language: { noResults: function () { return "No hay resultados.." }, inputTooLong: function (a) { var e = "Máximo " + b + " caracteres. Elimine " + overChars + " caracter"; return 1 != overChars && (e += "es"), e }, searching: function () { return "Buscando.." }, errorLoading: function () { return "Sin datos.." }, inputTooShort: function () { return "Ingresar " + f + " o mas caracteres" }, maximumSelected: function () { return "Puede seleccionar solo una opción" }, removeAllItems: function () { return "Borrar" } }, ajax: { url: "../data/getListOtrasNovedades.php", dataType: "json", type: "POST", delay: C, data: function (a) { return { q: a.term, Datos: e } }, processResults: function (a) { return { results: a } } } }), $(".selectjs_OtrasNovedades").on("select2:select", (function (a) { $("#FicValor").focus(), "" != $("#FicValor").val() && $("#FicValor").select() })), $("#RefreshModal").click((function (a) { CheckSesion(), T() })), $(".Form_Fichadas").bind("submit", (function (a) { a.preventDefault(), CheckSesion(), $.ajax({ type: $(this).attr("method"), url: $(this).attr("action"), data: $(this).serialize(), beforeSend: function (a) { _(), $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), $(".respuesta_fichada").html("Procesando.!"), $(".submit_btn").prop("disabled", !0) }, success: function (a) { "ok" == a.status ? (T(), F(), $(".RegHora").val(""), $(".Form_Fichadas").addClass("d-none"), ClearFormFic(), $.notifyClose(), notify("Fichada creada.<br>" + a.Mensaje, "success", 5e3, "right")) : (F(), T(), ClearFormFic(), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right")) } }), a.stopImmediatePropagation() })), $(document).on("click", ".mod_Fic", (function (a) { CheckSesion(), OcultaNavTab(), $(".Form_Fichadas_Mod").removeClass("d-none"), $(".Form_Fichadas_Mod").addClass("animate__animated animate__fadeIn"); let e = $(this).attr("data2"), t = ($(this).attr("data3"), $(this).attr("data")), o = $(this).attr("data-fechadr"); singleDatePicker("#RegFech_mod", "center", "down"), $("#RegFech_mod").data("daterangepicker").setStartDate(o), $("#RegFech_mod").data("daterangepicker").setEndDate(o), $("#datos_fichada_mod").val(t).trigger("change"), $("#RegHora_mod").val(e).trigger("change"), $(".submit_btn").prop("disabled", !1), $("#RegHora_mod").select(), $("#xsTFic").html("Modificar Fichada") })), $(".Form_Fichadas_Mod").bind("submit", (function (a) { a.preventDefault(), CheckSesion(), $.ajax({ type: $(this).attr("method"), url: $(this).attr("action"), data: $(this).serialize(), cache: !1, beforeSend: function (a) { $(".submit_btn").prop("disabled", !0), _(), $(".submit_btn").prop("disabled", !0), $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right") }, success: function (a) { "ok" == a.status ? ($(".submit_btn").prop("disabled", !1), T(), F(), $("#RegHora_mod").val(""), $(".Form_Fichadas_Mod").addClass("d-none"), ClearFormFic(), $.notifyClose(), notify("Fichada modificada.<br>" + a.Mensaje, "success", 5e3, "right")) : (F(), ClearFormFic(), $(".submit_btn").prop("disabled", !1), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right")) } }), a.stopImmediatePropagation() })), $(document).on("click", ".baja_Fic", (function (a) { a.preventDefault(), CheckSesion(); var e = $(this).attr("data2"), t = $(this).attr("data"); bootbox.confirm({ message: '<span class="fonth fw5 deleteFic">Eliminar Fichada</span><br><span class="fontq fw4">¿Confirma eliminar la Fichada: ' + e + "Hs.?</span>", buttons: { confirm: { label: "Aceptar", className: "btn-danger btn-sm fontq" }, cancel: { label: "Cancelar", className: "btn-light btn-sm fontq text-secondary" } }, callback: function (a) { $(".baja_Fic").unbind("click"), a && $.ajax({ type: "POST", url: "insert.php", data: { baja_fichada: !0, Datos: t }, beforeSend: function (a) { $(".baja_Fic").addClass("d-none"), $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), _() }, success: function (a) { "ok" == a.status ? (F(), $(".baja_Fic").removeClass("d-none"), T(), $(".Form_Fichadas").addClass("d-none"), $(".respuesta_baja_fichada").addClass("d-none"), $.notifyClose(), notify("Fichada Eliminada<br>" + a.Mensaje, "success", 5e3, "right")) : (F(), $(".baja_Fic").removeClass("d-none"), $(".respuesta_baja_fichada").removeClass("d-none"), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right")) } }) } }), $(".bootbox-confirm .modal-body").addClass("confirmDelete"), a.stopImmediatePropagation() })), $(document).ready((function () { $(".Form_Novedad").bind("submit", (function (a) { a.preventDefault(), CheckSesion(), $.ajax({ type: $(this).attr("method"), url: $(this).attr("action"), data: $(this).serialize(), beforeSend: function (a) { $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), _(), $(".submit_btn_mod").prop("disabled", !0) }, success: function (a) { if ("ok" == a.status) { if (F(), $(".Form_Novedad").addClass("d-none"), T(), ClearFormNov(), "mod" == a.tipo) var e = "Novedad modificada."; else e = "Novedad creada."; $.notifyClose(), notify(e + "<br>" + a.Mensaje, "success", 5e3, "right") } else F(), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right") } }), a.stopImmediatePropagation() })), $(document).on("click", "#FicCate", (function (a) { CheckSesion(), $("#FicCate").is(":checked") ? $("#novCate").val("1").trigger("change") : ($("#novCate").val("2").trigger("change"), $(".selectjs_Novedades").val(null).trigger("change"), $(".selectjs_NoveCausa").val(null).trigger("change")) })), $(document).on("click", ".mod_Nov", (function (a) { CheckSesion(), $("#xsTNov").html("Modificar Novedad"), OcultaNavTab(), $(".submit_btn_mod").prop("disabled", !1), $(".Form_Novedad").removeClass("d-none"), $(".Form_Novedad").addClass("animate__animated animate__fadeIn"), $(".submit_btn_mod").html("Modificar"), $("#FicHoras").select(); var e = $(this).attr("data"), t = $(this).attr("data2"), o = $(this).attr("data3"), n = $(this).attr("data4"), s = $(this).attr("data5"), r = $(this).attr("data6"), i = $(this).attr("data7"), l = $(this).attr("data8"), d = $(this).attr("data9"), c = $(this).attr("data10"); $("#novTipo").val(c).trigger("change"), 1 == i && $("#FicJust").prop("checked", !0), 2 == l && ($("#FicCate").prop("checked", !0), $("#FicCate").prop("disabled", !0)); var u = new Option(o, t, !0, !0); if ($(".selectjs_Novedades").append(u).trigger("change"), 0 != n) { u = new Option(s, n, !0, !0); $(".selectjs_NoveCausa").append(u).trigger("change") } $("#FicObse").val(r).trigger("change"), $("#alta_novedad").val("Mod"), $("#CNove").val(e).trigger("change"), $("#FicHoras").val(d).trigger("change") })), $(document).on("click", ".baja_Nov", (function (a) { a.preventDefault(), CheckSesion(); var e = $(this).attr("data2"), t = $(this).attr("data"); bootbox.confirm({ message: '<span class="fonth fw5">Eliminar Novedad</span><br><span class="fontq fw4">¿Confirma eliminar la Novedad: ' + e + "Hs.?</span>", buttons: { confirm: { label: "Aceptar", className: "btn-danger btn-sm fontq" }, cancel: { label: "Cancelar", className: "btn-light btn-sm fontq text-secondary" } }, callback: function (a) { $(".baja_Nov").unbind("click"), a && $.ajax({ type: "POST", url: "insert.php", data: { baja_novedad: !0, Datos: t, NovDes: e }, beforeSend: function (a) { $(".baja_Nov").addClass("d-none"), $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), _() }, success: function (a) { "ok" == a.status ? (F(), $(".Form_Novedad").addClass("d-none"), T(), $.notifyClose(), notify("Novedad eliminada<br>" + a.Mensaje, "success", 5e3, "right")) : (F(), T(), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right")) } }) } }), $(".bootbox-confirm .modal-body").addClass("confirmDelete"), a.stopImmediatePropagation() })) })), $(".Form_Horas").bind("submit", (function (a) { a.preventDefault(), CheckSesion(), $.ajax({ type: $(this).attr("method"), url: $(this).attr("action"), data: $(this).serialize(), beforeSend: function (a) { $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), _(), $(".submit_btn_HorMod").prop("disabled", !0) }, success: function (a) { if ("ok" == a.status) { if (F(), ClearFormHora(), T(), "mod" == a.tipo) var e = "Hora modificada."; else e = "Hora cargada."; $.notifyClose(), notify(e + "<br>" + a.Mensaje, "success", 5e3, "right") } else F(), $(".submit_btn_HorMod").prop("disabled", !1), T(), $(".respuesta_Horas").html(""), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right") } }), a.stopImmediatePropagation() })), $(document).on("click", ".mod_hora", (function (a) { CheckSesion(), a.preventDefault(), $("#xsTHor").html("Modificar Horas"), $(".Form_Horas").removeClass("d-none"), $(".Form_Horas").addClass("animate__animated animate__fadeIn"), $(".submit_btn_HorMod").html("Modificar"), $("#alta_horas").val("mod").trigger("change"), $("#modHora").val("1").trigger("change"), $(".submit_btn_HorMod").prop("disabled", !1); var e = $(this).attr("data"), t = $(this).attr("data1"), o = $(this).attr("data2"), n = $(this).attr("data3"), s = $(this).attr("data4"), r = $(this).attr("data5"), i = $(this).attr("data6"), l = new Option(n, e, !0, !0); if ($(".selectjs_TipoHora").append(l).trigger("change"), 0 != s) { l = new Option(r, s, !0, !0); $(".selectjs_MotivoHora").append(l).trigger("change") } $("#Fic1Observ").val(i).trigger("change"), $("#Fic1HsAu2").val(o).trigger("change"), $("#FicHsAu").val(t), $("#Fic1HsAu2").focus(), $("#Fic1HsAu2").select() })), $(document).on("click", ".baja_Hora", (function (a) { a.preventDefault(), CheckSesion(); var e = $(this).attr("data2"), t = $(this).attr("data"); bootbox.confirm({ message: '<span class="fonth fw5">Eliminar Hora</span><br><span class="fontq fw4">¿Confirma eliminar la Hora: ' + e + " ?</span>", buttons: { confirm: { label: "Aceptar", className: "btn-danger btn-sm fontq" }, cancel: { label: "Cancelar", className: "btn-light btn-sm fontq text-secondary" } }, callback: function (a) { $(".baja_Hora").unbind("click"), a && $.ajax({ type: "POST", url: "insert.php", data: { baja_Hora: !0, Datos: t, HoraDesc: e }, beforeSend: function (a) { $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), $(".baja_Hora").addClass("d-none"), _() }, success: function (a) { "ok" == a.status ? (F(), $(".Form_Horas").addClass("d-none"), $(".baja_Hora").removeClass("d-none"), T(), $.notifyClose(), notify("Hora eliminada<br>" + a.Mensaje, "success", 5e3, "right")) : (F(), T(), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right")) } }) } }), $(".bootbox-confirm .modal-body").addClass("confirmDelete"), a.stopImmediatePropagation() })), dobleDatePicker("#FicONovFechas", "bottom", !0); let N = e.split("-")[1]; N = N.substring(6, 8) + "/" + N.substring(4, 6) + "/" + N.substring(0, 4), $("#FicONovFechas").data("daterangepicker").setStartDate(N), $("#FicONovFechas").data("daterangepicker").setEndDate(N), $(".Form_OtraNovedad").bind("submit", (function (a) { a.preventDefault(), CheckSesion(), $.ajax({ type: $(this).attr("method"), url: $(this).attr("action"), data: $(this).serialize(), beforeSend: function (a) { $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), _(), $(".submit_btn_OtrasNov").prop("disabled", !0) }, success: function (a) { if ("ok" == a.status) if (F(), ClearFormONov(), T(), $.notifyClose(), "mod" == a.tipo) { notify("Novedad modificada." + "<br>" + a.Mensaje, "success", 5e3, "right") } else { let e = "Novedad creada."; if (Array.isArray(a.Mensaje)) { let t = a.Mensaje.join("<br>"); notify(e + "<br>" + t, "success", 5e3, "right") } else notify(e + "<br>" + a.Mensaje, "success", 5e3, "right") } else $(".submit_btn_OtrasNov").prop("disabled", !1), $(".respuesta_OtrasNov").html(""), F(), T(), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right") } }), a.stopImmediatePropagation() })), $(document).on("click", ".mod_ONov", (function (a) { a.preventDefault(), CheckSesion(), ClearFormONov(), $("#xsTOnov").html("Modificar Novedad"), $(".submit_btn_OtrasNov").prop("disabled", !1), $(".Form_OtraNovedad").removeClass("d-none"), $(".Form_OtraNovedad").addClass("animate__animated animate__fadeIn"), $(".submit_btn_OtrasNov").html("Modificar"), $("#alta_OtrasNov").val("mod").trigger("change"); var e = $(this).attr("data1"), t = $(this).attr("data2"), o = $(this).attr("data3"), n = $(this).attr("data4"), s = new Option(e, n, !0, !0); $(".selectjs_OtrasNovedades").append(s).trigger("change"), $("#FicValor").val(o).trigger("change"), $("#FicObsN").val(t).trigger("change"), $("#FicValor").focus(), "" != $("#FicValor").val() && $("#FicValor").select(), a.stopImmediatePropagation() })), $(document).on("click", ".baja_ONov", (function (a) { a.preventDefault(), CheckSesion(); var e = $(this).attr("data2"), t = $(this).attr("data"); bootbox.confirm({ message: '<span class="fonth fw5">Eliminar Novedad</span><br><span class="fontq fw4">¿Confirma eliminar la Novedad: ' + e + "?</span>", buttons: { confirm: { label: "Aceptar", className: "btn-danger btn-sm fontq" }, cancel: { label: "Cancelar", className: "btn-light btn-sm fontq text-secondary" } }, callback: function (a) { a && $.ajax({ type: "POST", url: "insert.php", data: { baja_ONov: !0, Datos: t, Descrip: e }, beforeSend: function (a) { _(), $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right") }, success: function (a) { "ok" == a.status ? (F(), $(".respuesta_OtrasNov").html(""), $.notifyClose(), notify("Novedad eliminada<br>" + a.Mensaje, "success", 5e3, "right"), T()) : (F(), T(), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right")) } }) } }), $(".bootbox-confirm .modal-body").addClass("confirmDelete"), a.stopImmediatePropagation() })), $(".Form_Citacion").bind("submit", (function (a) { CheckSesion(), a.preventDefault(), $.ajax({ type: $(this).attr("method"), url: $(this).attr("action"), data: $(this).serialize(), beforeSend: function (a) { $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right"), $(".submit_btn_Citación").prop("disabled", !0), _() }, success: function (a) { if ("ok" == a.status) { F(), ClearFormCitacion(), T(); var e = "mod" == a.tipo ? "Citación Modificada." : "Citación Creada."; $.notifyClose(), notify(e + "<br>" + a.Mensaje, "success", 5e3, "right") } else F(), $(".submit_btn_Citación").prop("disabled", !1), T(), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right") } }) })), $(document).ready((function () { $("#Citacion").on("click", (function (a) { CheckSesion(), p(), a.preventDefault(), $("#rowCitacion").removeClass("d-none"), $("#rowCitacion").addClass("animate__animated animate__fadeIn"), $("#alta_Citación").val("true").trigger("change"), a.stopImmediatePropagation(), $("#CitEntra").focus(), "" != $("#CitEntra").val() && $("#CitEntra").select() })), $("#bCit").on("click", (function (a) { a.preventDefault(), CheckSesion(); var e = $(this).attr("datos"); bootbox.confirm({ message: '<span class="fonth fw5">Eliminar Citación</span><br><span class="fontq fw4">¿Confirma eliminar la Citación?</span>', buttons: { confirm: { label: "Aceptar", className: "btn-danger btn-sm fontq" }, cancel: { label: "Cancelar", className: "btn-light btn-sm fontq text-secondary" } }, callback: function (a) { a && $.ajax({ type: "POST", url: "insert.php", data: { baja_Cit: !0, Datos: e }, beforeSend: function (a) { _(), $.notifyClose(), notify('Procesando <span class = "dotting mr-1"> </span> ' + loading, "info", 0, "right") }, success: function (a) { "ok" == a.status ? (F(), ClearFormCitacion(), T(), $(".respuesta_OtrasNov").html(""), $.notifyClose(), notify(a.Mensaje, "success", 5e3, "right")) : (F(), T(), $.notifyClose(), notify(a.Mensaje, "danger", 5e3, "right")) } }) } }), $(".bootbox-confirm .modal-body").addClass("confirmDelete"), a.stopImmediatePropagation() })), l && (p(), $("#rowCitacion").removeClass("d-none"), $("#rowCitacion").addClass("animate__animated animate__fadeIn"), $("#alta_Citación").val("true").trigger("change"), $("#Navs").addClass("d-none"), Modal_XL_LG("#TopN"), setTimeout((function () { $("#CitEntra").focus(), "" != $("#CitEntra").val() && $("#CitEntra").select() }), 500)) })), $("#Fichadas-tab").on("hide.bs.tab", (function (a) { $("#AddFic").addClass("d-none"), ClearFormFic() })), $("#Fichadas-tab").on("shown.bs.tab", (function (a) { $("#AddFic").removeClass("d-none") })), $("#Novedades-tab").on("hide.bs.tab", (function (a) { $("#AddNov").addClass("d-none"), ClearFormNov() })), $("#Novedades-tab").on("shown.bs.tab", (function (a) { $("#AddNov").removeClass("d-none"), $("#novCate").val("2").trigger("change") })), $("#Horas-tab").on("hide.bs.tab", (function (a) { $("#AddHora").addClass("d-none"), ClearFormHora() })), $("#Horas-tab").on("shown.bs.tab", (function (a) { $("#AddHora").removeClass("d-none") })), $("#OtrasNov-tab").on("show.bs.tab", (function (a) { $("#AddONov").removeClass("d-none") })), $("#OtrasNov-tab").on("hide.bs.tab", (function (a) { $("#AddONov").addClass("d-none"), ClearFormONov() })) })), $("#Exportar").on("shown.bs.modal", (function (a) { a.stopImmediatePropagation(), CheckSesion() })), $("#Exportar").on("hidden.bs.modal", (function (a) { a.stopImmediatePropagation(), CheckSesion(), atajosTeclado() })), $("#modalGeneral").on("hidden.bs.modal", (function () { $("#bCit").hide(), DestroyDataTablesModal(), ClearFormFic(), Modal_LG_XL("#TopN"), $("#FicHsAT").html(""), $("#TextFicHsAT").html(""), $("#divHorasTR").addClass("d-none"), $("#FicHorario").html(""), $("#ProgressHoras").html(""), $("#FicHsTr").html(""), $("#TextFicHsTr").html(""), $("#Navs").removeClass("d-none"), $(".nav").removeClass("d-none"), $("#RefreshModal").off("click"), $("#AddFic").off("click"), $("#AddNov").off("click"), $("#AddHora").off("click"), $("#AddONov").off("click"), $("#ProcesarLegajo").off("click"), $("#ProcesarLegajo").unbind("click"), $(".cancelar_btn_fic").off("click"), $(".cancelar_btn_nov").off("click"), $("#cancelar_btn_hor").off("click"), $("#cancelar_btn_OtrasNov").off("click"), $(".mod_Fic").off("click"), $(".baja_ONov").off("click"), $("#FicCate").off("click"), $("#Citacion").off("click"), $("#Citacion").unbind("click"), $(".mod_Nov").off("click"), $(".mod_hora").off("click"), $(".mod_ONov").off("click"), $(".Form_Citacion").unbind("submit"), $("#cancelar_btn_Citación").off("click"), ClearFormCitacion(), $(document).off("click", ".mod_Fic"), $(document).off("click", ".baja_Fic"), $(document).off("click", ".mod_hora"), $(document).off("click", ".baja_Hora"), $(document).off("click", ".mod_Nov"), $(document).off("click", ".baja_Nov"), $(document).off("click", ".mod_ONov"), $(document).off("click", ".baja_ONov"), $("#nav-tabContent").removeClass("border"), $("#Fichadas").addClass("border border-top-0"), $("#Fichadas").removeClass("d-none"), $("#Novedades").removeClass("d-none"), $("#Horas").removeClass("d-none"), $("#OtrasNov").removeClass("d-none"), $("#CitEntra").val(""), $("#CitSale").val(""), $("#CitDesc").val("00:00"), $("#Mxs").val(""), MuestraNavTab(), $("#xsTFic").html("Fichadas"), $("#xsTNov").html("Novedades"), $("#xsTHor").html("Horas"), $("#xsTOnov").html("Otras Novedades"), $(".navbar").removeClass("mr-0"), $("#nav-tab").show(), atajosTeclado(), $("#Citacion").prop("disabled", !0), $("#Citacion").hide(), $("#FicHorario").removeClass("mt-1") }));